var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(){function t(t,e){"use strict";function n(t,e){for(var n=0;n<t.length;n++)if(t[n].key===e)return t[n]}var r={version:"3.0.2",constants:{CHART_CLASS:"dc-chart",DEBUG_GROUP_CLASS:"debug",STACK_CLASS:"stack",DESELECTED_CLASS:"deselected",SELECTED_CLASS:"selected",NODE_INDEX_NAME:"__index__",GROUP_INDEX_NAME:"__group_index__",DEFAULT_CHART_GROUP:"__default_chart_group__",EVENT_DELAY:40,NEGLIGIBLE_NUMBER:1e-10},_renderlet:null};r.chartRegistry=function(){function t(t){return t||(t=r.constants.DEFAULT_CHART_GROUP),e[t]||(e[t]=[]),t}var e={};return{has:function(t){for(var n in e)if(e[n].indexOf(t)>=0)return!0;return!1},register:function(n,r){r=t(r),e[r].push(n)},deregister:function(n,r){r=t(r);for(var i=0;i<e[r].length;i++)if(e[r][i].anchorName()===n.anchorName()){e[r].splice(i,1);break}},clear:function(t){t?delete e[t]:e={}},list:function(n){return n=t(n),e[n]}}}(),r.registerChart=function(t,e){r.chartRegistry.register(t,e)},r.deregisterChart=function(t,e){r.chartRegistry.deregister(t,e)},r.hasChart=function(t){return r.chartRegistry.has(t)},r.deregisterAllCharts=function(t){r.chartRegistry.clear(t)},r.filterAll=function(t){for(var e=r.chartRegistry.list(t),n=0;n<e.length;++n)e[n].filterAll()},r.refocusAll=function(t){for(var e=r.chartRegistry.list(t),n=0;n<e.length;++n)e[n].focus&&e[n].focus()},r.renderAll=function(t){for(var e=r.chartRegistry.list(t),n=0;n<e.length;++n)e[n].render();null!==r._renderlet&&r._renderlet(t)},r.redrawAll=function(t){for(var e=r.chartRegistry.list(t),n=0;n<e.length;++n)e[n].redraw();null!==r._renderlet&&r._renderlet(t)},r.disableTransitions=!1,r.transition=function(t,e,n,i){if(r.disableTransitions||e<=0)return t;var a=t.transition(i);return(e>=0||void 0!==e)&&(a=a.duration(e)),(n>=0||void 0!==n)&&(a=a.delay(n)),a},r.optionalTransition=function(t,e,n,i){return t?function(t){return r.transition(t,e,n,i)}:function(t){return t}},r.afterTransition=function(t,e){if(t.empty()||!t.duration)e.call(t);else{var n=0;t.each(function(){++n}).on("end",function(){--n||e.call(t)})}},r.units={},r.units.integers=function(t,e){return Math.abs(e-t)},r.units.ordinal=function(){throw new Error("dc.units.ordinal should not be called - it is a placeholder")},r.units.fp={},r.units.fp.precision=function(t){var e=function t(e,n){var i=Math.abs((n-e)/t.resolution);return r.utils.isNegligible(i-Math.floor(i))?Math.floor(i):Math.ceil(i)};return e.resolution=t,e},r.round={},r.round.floor=function(t){return Math.floor(t)},r.round.ceil=function(t){return Math.ceil(t)},r.round.round=function(t){return Math.round(t)},r.override=function(t,e,n){var r=t[e];t["_"+e]=r,t[e]=n},r.renderlet=function(t){return arguments.length?(r._renderlet=t,r):r._renderlet},r.instanceOfChart=function(t){return t instanceof Object&&t.__dcFlag__&&!0},r.errors={},r.errors.Exception=function(t){var e=t||"Unexpected internal error";this.message=e,this.toString=function(){return e},this.stack=(new Error).stack},r.errors.Exception.prototype=Object.create(Error.prototype),r.errors.Exception.prototype.constructor=r.errors.Exception,r.errors.InvalidStateException=function(){r.errors.Exception.apply(this,arguments)},r.errors.InvalidStateException.prototype=Object.create(r.errors.Exception.prototype),r.errors.InvalidStateException.prototype.constructor=r.errors.InvalidStateException,r.errors.BadArgumentException=function(){r.errors.Exception.apply(this,arguments)},r.errors.BadArgumentException.prototype=Object.create(r.errors.Exception.prototype),r.errors.BadArgumentException.prototype.constructor=r.errors.BadArgumentException,r.dateFormat=t.timeFormat("%m/%d/%Y"),r.printers={},r.printers.filters=function(t){for(var e="",n=0;n<t.length;++n)n>0&&(e+=", "),e+=r.printers.filter(t[n]);return e},r.printers.filter=function(t){var e="";return void 0!==t&&null!==t&&(t instanceof Array?t.length>=2?e="["+r.utils.printSingleValue(t[0])+" -> "+r.utils.printSingleValue(t[1])+"]":t.length>=1&&(e=r.utils.printSingleValue(t[0])):e=r.utils.printSingleValue(t)),e},r.pluck=function(t,e){return e?function(n,r){return e.call(n,n[t],r)}:function(e){return e[t]}},r.utils={},r.utils.printSingleValue=function(t){var e=""+t;return t instanceof Date?e=r.dateFormat(t):"string"==typeof t?e=t:r.utils.isFloat(t)?e=r.utils.printSingleValue.fformat(t):r.utils.isInteger(t)&&(e=Math.round(t)),e},r.utils.printSingleValue.fformat=t.format(".2f"),r.utils.toTimeFunc=function(t){return"time"+t.charAt(0).toUpperCase()+t.slice(1)},r.utils.add=function(e,n,i){if("string"==typeof n&&(n=n.replace("%","")),e instanceof Date)return"string"==typeof n&&(n=+n),"millis"===i?new Date(e.getTime()+n):(i=i||t.timeDay,"function"!=typeof i&&(i=t[r.utils.toTimeFunc(i)]),i.offset(e,n));if("string"==typeof n){var a=+n/100;return e>0?e*(1+a):e*(1-a)}return e+n},r.utils.subtract=function(e,n,i){if("string"==typeof n&&(n=n.replace("%","")),e instanceof Date)return"string"==typeof n&&(n=+n),"millis"===i?new Date(e.getTime()-n):(i=i||t.timeDay,"function"!=typeof i&&(i=t[r.utils.toTimeFunc(i)]),i.offset(e,-n));if("string"==typeof n){var a=+n/100;return e<0?e*(1+a):e*(1-a)}return e-n},r.utils.isNumber=function(t){return t===+t},r.utils.isFloat=function(t){return t===+t&&t!==(0|t)},r.utils.isInteger=function(t){return t===+t&&t===(0|t)},r.utils.isNegligible=function(t){return!r.utils.isNumber(t)||t<r.constants.NEGLIGIBLE_NUMBER&&t>-r.constants.NEGLIGIBLE_NUMBER},r.utils.clamp=function(t,e,n){return t<e?e:t>n?n:t},r.utils.constant=function(t){return function(){return t}};var i=0;return r.utils.uniqueId=function(){return++i},r.utils.nameToId=function(t){return t.toLowerCase().replace(/[\s]/g,"_").replace(/[\.']/g,"")},r.utils.appendOrSelect=function(t,e,n){n=n||e;var r=t.select(e);return r.empty()&&(r=t.append(n)),r},r.utils.safeNumber=function(t){return r.utils.isNumber(+t)?+t:0},r.utils.arraysEqual=function(t,e){return t&&e?t.length===e.length&&t.every(function(t,n){return t===e[n]||t.toString()===e[n].toString()}):t===e},r.utils.allChildren=function(t){var e=[];if(e.push(t.path),console.log("currentNode",t),t.children)for(var n=0;n<t.children.length;n++)e=e.concat(r.utils.allChildren(t.children[n]));return e},r.utils.toHierarchy=function(t,e){for(var r={key:"root",children:[]},i=0;i<t.length;i++)for(var a=t[i],o=a.key,l=e(a),u=r,c=0;c<o.length;c++){var s,d=o.slice(0,c+1),f=u.children,h=o[c];c+1<o.length?(s=n(f,h),void 0===s&&(s={key:h,children:[],path:d},f.push(s)),u=s):(s={key:h,value:l,data:a,path:d},f.push(s))}return r},r.utils.getAncestors=function(t){for(var e=[],n=t;n.parent;)e.unshift(n.name),n=n.parent;return e},r.utils.arraysIdentical=function(t,e){var n=t.length;if(n!==e.length)return!1;for(;n--;)if(t[n]!==e[n])return!1;return!0},r.logger=function(){var t={};t.enableDebugLog=!1,t.warn=function(e){return console&&(console.warn?console.warn(e):console.log&&console.log(e)),t};var e={};return t.warnOnce=function(n){return e[n]||(e[n]=!0,r.logger.warn(n)),t},t.debug=function(e){return t.enableDebugLog&&console&&(console.debug?console.debug(e):console.log&&console.log(e)),t},t.deprecate=function(e,n){function r(){return i||(t.warn(n),i=!0),e.apply(this,arguments)}var i=!1;return r},t}(),r.config=function(){var t={},e=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"],n=e;return t.defaultColors=function(i){return arguments.length?(n=i,t):(n===e&&r.logger.warnOnce("You are using d3.schemeCategory20c, which has been removed in D3v5. See the explanation at https://github.com/d3/d3/blob/master/CHANGES.md#changes-in-d3-50. DC is using it for backward compatibility, however it will be changed in DCv3.1. You can change it by calling dc.config.defaultColors(newScheme). See https://github.com/d3/d3-scale-chromatic for some alternatives."),n)},t}(),r.events={current:null},r.events.trigger=function(t,e){if(!e)return void t();r.events.current=t,setTimeout(function(){t===r.events.current&&t()},e)},r.filters={},r.filters.RangedFilter=function(t,e){var n=new Array(t,e);return n.isFiltered=function(t){return t>=this[0]&&t<this[1]},n.filterType="RangedFilter",n},r.filters.TwoDimensionalFilter=function(t){if(null===t)return null;var e=t;return e.isFiltered=function(t){return t.length&&t.length===e.length&&t[0]===e[0]&&t[1]===e[1]},e.filterType="TwoDimensionalFilter",e},r.filters.RangedTwoDimensionalFilter=function(t){if(null===t)return null;var e,n=t;return e=n[0]instanceof Array?[[Math.min(t[0][0],t[1][0]),Math.min(t[0][1],t[1][1])],[Math.max(t[0][0],t[1][0]),Math.max(t[0][1],t[1][1])]]:[[t[0],-1/0],[t[1],1/0]],n.isFiltered=function(t){var n,r;return t instanceof Array?(n=t[0],r=t[1]):(n=t,r=e[0][1]),n>=e[0][0]&&n<e[1][0]&&r>=e[0][1]&&r<e[1][1]},n.filterType="RangedTwoDimensionalFilter",n},r.filters.HierarchyFilter=function(t){if(null===t)return null;var e=t.slice(0);return e.isFiltered=function(t){if(!(e.length&&t&&t.length&&t.length>=e.length))return!1;for(var n=0;n<e.length;n++)if(t[n]!==e[n])return!1;return!0},e},r.baseMixin=function(n){function i(){f&&(D?f.attr("viewBox")||f.attr("viewBox","0 0 "+n.width()+" "+n.height()):f.attr("width",n.width()).attr("height",n.height()))}function a(){return f=n.root().append("svg"),i(),f}function o(t){if(!n[t]||!n[t]())throw new r.errors.InvalidStateException("Mandatory attribute chart."+t+" is missing on chart[#"+n.anchorName()+"]")}function l(t){if(n.dimension()&&n.dimension().filter){var e=z(n.dimension(),t);e&&(t=e)}return t}n.__dcFlag__=r.utils.uniqueId();var u,c,s,d,f,h,g,p,y,m,v,x=200,A=function(t){var e=t&&t.getBoundingClientRect&&t.getBoundingClientRect().width;return e&&e>x?e:x},b=A,_=200,k=function(t){var e=t&&t.getBoundingClientRect&&t.getBoundingClientRect().height;return e&&e>_?e:_},w=k,D=!1,C=r.pluck("key"),L=r.pluck("value"),E=r.pluck("key"),R=r.pluck("key"),O=!1,S=function(t){return n.keyAccessor()(t)+": "+n.valueAccessor()(t)},M=!0,F=!1,B=750,T=0,N=r.printers.filters,H=["dimension","group"],P=r.constants.DEFAULT_CHART_GROUP,G=t.dispatch("preRender","postRender","preRedraw","postRedraw","filtered","zoomed","renderlet","pretransition"),V=[],z=function(t,e){return 0===e.length?t.filter(null):1!==e.length||e[0].isFiltered?1===e.length&&"RangedFilter"===e[0].filterType?t.filterRange(e[0]):t.filterFunction(function(t){for(var n=0;n<e.length;n++){var r=e[n];if(r.isFiltered&&r.isFiltered(t))return!0;if(r<=t&&r>=t)return!0}return!1}):t.filterExact(e[0]),e},U=function(t){return t.all()};n.height=function(t){return arguments.length?(w=t?"function"==typeof t?t:r.utils.constant(t):k,p=void 0,n):(r.utils.isNumber(p)||(p=w(d.node())),p)},n.width=function(t){return arguments.length?(b=t?"function"==typeof t?t:r.utils.constant(t):A,g=void 0,n):(r.utils.isNumber(g)||(g=b(d.node())),g)},n.minWidth=function(t){return arguments.length?(x=t,n):x},n.minHeight=function(t){return arguments.length?(_=t,n):_},n.useViewBoxResizing=function(t){return arguments.length?(D=t,n):D},n.dimension=function(t){return arguments.length?(u=t,n.expireCache(),n):u},n.data=function(t){return arguments.length?(U="function"==typeof t?t:r.utils.constant(t),n.expireCache(),n):U.call(n,c)},n.group=function(t,e){return arguments.length?(c=t,n._groupName=e,n.expireCache(),n):c},n.ordering=function(t){return arguments.length?(R=t,y=e.quicksort.by(R),n.expireCache(),n):R},n._computeOrderedGroups=function(t){var n=t.slice(0);return n.length<=1?n:(y||(y=e.quicksort.by(R)),y(n,0,n.length))},n.filterAll=function(){return n.filter(null)},n.select=function(t){return d.select(t)},n.selectAll=function(t){return d?d.selectAll(t):null},n.anchor=function(e,i){if(!arguments.length)return s;if(r.instanceOfChart(e))s=e.anchor(),d=e.root(),h=!0;else{if(!e)throw new r.errors.BadArgumentException("parent must be defined");s=e.select&&e.classed?e.node():e,d=t.select(s),d.classed(r.constants.CHART_CLASS,!0),r.registerChart(n,i),h=!1}return P=i,n},n.anchorName=function(){var t=n.anchor();return t&&t.id?t.id:t&&t.replace?t.replace("#",""):"dc-chart"+n.chartID()},n.root=function(t){return arguments.length?(d=t,n):d},n.svg=function(t){return arguments.length?(f=t,n):f},n.resetSvg=function(){return n.select("svg").remove(),a()},n.filterPrinter=function(t){return arguments.length?(N=t,n):N},n.controlsUseVisibility=function(t){return arguments.length?(F=t,n):F},n.turnOnControls=function(){if(d){var t=n.controlsUseVisibility()?"visibility":"display";n.selectAll(".reset").style(t,null),n.selectAll(".filter").text(N(n.filters())).style(t,null)}return n},n.turnOffControls=function(){if(d){var t=n.controlsUseVisibility()?"visibility":"display",e=n.controlsUseVisibility()?"hidden":"none";n.selectAll(".reset").style(t,e),n.selectAll(".filter").style(t,e).text(n.filter())}return n},n.transitionDuration=function(t){return arguments.length?(B=t,n):B},n.transitionDelay=function(t){return arguments.length?(T=t,n):T},n._mandatoryAttributes=function(t){return arguments.length?(H=t,n):H},n.render=function(){p=g=void 0,G.call("preRender",n,n),H&&H.forEach(o);var t=n._doRender();return m&&m.render(),n._activateRenderlets("postRender"),t},n._activateRenderlets=function(t){G.call("pretransition",n,n),n.transitionDuration()>0&&f?f.transition().duration(n.transitionDuration()).delay(n.transitionDelay()).on("end",function(){G.call("renderlet",n,n),t&&G.call(t,n,n)}):(G.call("renderlet",n,n),t&&G.call(t,n,n))},n.redraw=function(){i(),G.call("preRedraw",n,n);var t=n._doRedraw();return m&&m.render(),n._activateRenderlets("postRedraw"),t},n.commitHandler=function(t){return arguments.length?(v=t,n):v},n.redrawGroup=function(){return v?v(!1,function(t,e){t?console.log(t):r.redrawAll(n.chartGroup())}):r.redrawAll(n.chartGroup()),n},n.renderGroup=function(){return v?v(!1,function(t,e){t?console.log(t):r.renderAll(n.chartGroup())}):r.renderAll(n.chartGroup()),n},n._invokeFilteredListener=function(t){void 0!==t&&G.call("filtered",n,n,t)},n._invokeZoomedListener=function(){G.call("zoomed",n,n)};var Y=function(t,e){return null===e||void 0===e?t.length>0:t.some(function(t){return e<=t&&e>=t})};n.hasFilterHandler=function(t){return arguments.length?(Y=t,n):Y},n.hasFilter=function(t){return Y(V,t)};var I=function(t,e){for(var n=0;n<t.length;n++)if(t[n]<=e&&t[n]>=e){t.splice(n,1);break}return t};n.removeFilterHandler=function(t){return arguments.length?(I=t,n):I};var j=function(t,e){return t.push(e),t};n.addFilterHandler=function(t){return arguments.length?(j=t,n):j};var X=function(t){return[]};return n.resetFilterHandler=function(t){return arguments.length?(X=t,n):X},n.replaceFilter=function(t){return V=X(V),n.filter(t),n},n.filter=function(t){if(!arguments.length)return V.length>0?V[0]:null;var e=V;return t instanceof Array&&t[0]instanceof Array&&!t.isFiltered?t[0].forEach(function(t){e=Y(e,t)?I(e,t):j(e,t)}):e=null===t?X(e):Y(e,t)?I(e,t):j(e,t),V=l(e),n._invokeFilteredListener(t),null!==d&&n.hasFilter()?n.turnOnControls():n.turnOffControls(),n},n.filters=function(){return V},n.highlightSelected=function(e){t.select(e).classed(r.constants.SELECTED_CLASS,!0),t.select(e).classed(r.constants.DESELECTED_CLASS,!1)},n.fadeDeselected=function(e){t.select(e).classed(r.constants.SELECTED_CLASS,!1),t.select(e).classed(r.constants.DESELECTED_CLASS,!0)},n.resetHighlight=function(e){t.select(e).classed(r.constants.SELECTED_CLASS,!1),t.select(e).classed(r.constants.DESELECTED_CLASS,!1)},n.onClick=function(t){var e=n.keyAccessor()(t);r.events.trigger(function(){n.filter(e),n.redrawGroup()})},n.filterHandler=function(t){return arguments.length?(z=t,n):z},n._doRender=function(){return n},n._doRedraw=function(){return n},n.legendables=function(){return[]},n.legendHighlight=function(){},n.legendReset=function(){},n.legendToggle=function(){},n.isLegendableHidden=function(){return!1},n.keyAccessor=function(t){return arguments.length?(C=t,n):C},n.valueAccessor=function(t){return arguments.length?(L=t,n):L},n.label=function(t,e){return arguments.length?(E=t,(void 0===e||e)&&(O=!0),n):E},n.renderLabel=function(t){return arguments.length?(O=t,n):O},n.title=function(t){return arguments.length?(S=t,n):S},n.renderTitle=function(t){return arguments.length?(M=t,n):M},n.renderlet=r.logger.deprecate(function(t){return n.on("renderlet."+r.utils.uniqueId(),t),n},'chart.renderlet has been deprecated.  Please use chart.on("renderlet.<renderletKey>", renderletFunction)'),n.chartGroup=function(t){return arguments.length?(h||r.deregisterChart(n,P),P=t,h||r.registerChart(n,P),n):P},n.expireCache=function(){return n},n.legend=function(t){return arguments.length?(m=t,m.parent(n),n):m},n.chartID=function(){return n.__dcFlag__},n.options=function(t){var e=["anchor","group","xAxisLabel","yAxisLabel","stack","title","point","getColor","overlayGeoJson"];for(var i in t)"function"==typeof n[i]?t[i]instanceof Array&&-1!==e.indexOf(i)?n[i].apply(n,t[i]):n[i].call(n,t[i]):r.logger.debug("Not a valid option setter name: "+i);return n},n.on=function(t,e){return G.on(t,e),n},n},r.marginMixin=function(t){var e={top:10,right:50,bottom:30,left:30};return t.margins=function(n){return arguments.length?(e=n,t):e},t.effectiveWidth=function(){return t.width()-t.margins().left-t.margins().right},t.effectiveHeight=function(){return t.height()-t.margins().top-t.margins().bottom},t},r.colorMixin=function(e){var n=t.scaleOrdinal(r.config.defaultColors()),i=!0,a=function(t){return e.keyAccessor()(t)};return e.colors=function(i){return arguments.length?(n=i instanceof Array?t.scaleQuantize().range(i):"function"==typeof i?i:r.utils.constant(i),e):n},e.ordinalColors=function(n){return e.colors(t.scaleOrdinal().range(n))},e.linearColors=function(n){return e.colors(t.scaleLinear().range(n).interpolate(t.interpolateHcl))},e.colorAccessor=function(t){return arguments.length?(a=t,i=!1,e):a},e.defaultColorAccessor=function(){return i},e.colorDomain=function(t){return arguments.length?(n.domain(t),e):n.domain()},e.calculateColorDomain=function(){var r=[t.min(e.data(),e.colorAccessor()),t.max(e.data(),e.colorAccessor())];return n.domain(r),e},e.getColor=function(t,e){return n(a.call(this,t,e))},e.colorCalculator=r.logger.deprecate(function(t){return arguments.length?(e.getColor=t,e):e.getColor},"colorMixin.colorCalculator has been deprecated. Please colorMixin.colors and colorMixin.colorAccessor instead"),e},r.coordinateGridMixin=function(e){function n(n,a){e.isOrdinal()?(_.bandwidth||(r.logger.warn("For compatibility with d3v4+, dc.js d3.0 ordinal bar/line/bubble charts need d3.scaleBand() for the x scale, instead of d3.scaleOrdinal(). Replacing .x() with a d3.scaleBand with the same domain - make the same change in your code to avoid this warning!"),_=t.scaleBand().domain(_.domain())),(e.elasticX()||0===_.domain().length)&&_.domain(e._ordinalXDomain())):e.elasticX()&&_.domain([e.xAxisMin(),e.xAxisMax()]);var o=_.domain();!a&&r.utils.arraysEqual(C,o)||e.rescale(),C=o,e.isOrdinal()?_.range([0,e.xAxisLength()]).paddingInner(it).paddingOuter(e._useOuterPadding()?rt:0):_.range([0,e.xAxisLength()]),B=B.scale(e.x()),i(n)}function i(t){var n=t.select("g."+v);if(W){n.empty()&&(n=t.insert("g",":first-child").attr("class",m+" "+v).attr("transform","translate("+e.margins().left+","+e.margins().top+")"));var i=B.tickValues()?B.tickValues():"function"==typeof _.ticks?_.ticks.apply(_,B.tickArguments()):_.domain(),a=n.selectAll("line").data(i),o=a.enter().append("line").attr("x1",function(t){return _(t)}).attr("y1",e._xAxisY()-e.margins().top).attr("x2",function(t){return _(t)}).attr("y2",0).attr("opacity",0);r.transition(o,e.transitionDuration(),e.transitionDelay()).attr("opacity",1);var l=o.merge(a);r.transition(l,e.transitionDuration(),e.transitionDelay()).attr("x1",function(t){return _(t)}).attr("y1",e._xAxisY()-e.margins().top).attr("x2",function(t){return _(t)}).attr("y2",0),a.exit().remove()}else n.selectAll("line").remove()}function a(){return at?t.axisRight():t.axisLeft()}function o(){return e.anchorName().replace(/[ .#=\[\]"]/g,"-")+"-clip"}function l(){var t=r.utils.appendOrSelect(x,"defs"),n=o(),i=r.utils.appendOrSelect(t,"#"+n,"clipPath").attr("id",n),a=2*nt;r.utils.appendOrSelect(i,"rect").attr("width",e.xAxisLength()+a).attr("height",e.yAxisHeight()+a).attr("transform","translate(-"+nt+", -"+nt+")")}function u(t){e.isOrdinal()&&(j=!1),n(e.g(),t),e._prepareYAxis(e.g()),e.plotData(),(e.elasticX()||K||t)&&e.renderXAxis(e.g()),(e.elasticY()||K||t)&&e.renderYAxis(e.g()),t?e.renderBrush(e.g(),!1):e.redrawBrush(e.filter(),K),e.fadeDeselectedArea(e.filter()),K=!1}function c(){k=_.copy(),et?e._enableMouseZoom():tt&&e._disableMouseZoom()}function s(t,n){var i;y(t)?(e.x().domain(t),i=r.filters.RangedFilter(t[0],t[1])):(e.x().domain(w),i=null),e.replaceFilter(i),e.rescale(),e.redraw(),n||(M&&!p(e.filter(),M.filter())&&r.events.trigger(function(){M.replaceFilter(i),M.redraw()}),e._invokeZoomedListener(),r.events.trigger(function(){e.redrawGroup()},r.constants.EVENT_DELAY))}function d(e,n,r){var i=(n[1]-n[0])/(e[1]-e[0]),a=-1*r(e[0]);return t.zoomIdentity.scale(i).translate(a,0)}function f(){J&&J.transform(e.root(),d(e.x().domain(),w,k))}function h(){if(t.event.sourceEvent&&(!t.event.sourceEvent.type||-1===["start","zoom","end"].indexOf(t.event.sourceEvent.type))){var n=t.event.transform.rescaleX(k).domain();e.focus(n,!1)}}function g(t,e){return t&&2===t.length&&e&&2===e.length?((t[0]>e[1]||t[1]<e[0])&&console.warn("Could not intersect extents, will reset"),[t[0]>e[0]?t[0]:e[0],t[1]<e[1]?t[1]:e[1]]):t}function p(t,e){return!t&&!e||!(!t||!e)&&(0===t.length&&0===e.length||t[0].valueOf()===e[0].valueOf()&&t[1].valueOf()===e[1].valueOf())}function y(t){return t instanceof Array&&t.length>1}var m="grid-line",v="vertical";e=r.colorMixin(r.marginMixin(r.baseMixin(e))),e.colors(t.scaleOrdinal(t.schemeCategory10)),e._mandatoryAttributes().push("x");var x,A,b,_,k,w,D,C,L,E,R,O,S,M,F,B=t.axisBottom(),T=r.units.integers,N=0,H=t.timeDay,P=!1,G=0,V=null,z=0,U=!1,Y=0,I=t.brushX(),j=!0,X=!1,q=!1,W=!1,K=!1,Z=[1,1/0],Q=!0,J=t.zoom().on("zoom",h),$=t.zoom().on("zoom",null),tt=!1,et=!1,nt=0,rt=.5,it=0,at=!1;return e.rescale=function(){return S=void 0,K=!0,e},e.resizing=function(){return K},e.rangeChart=function(t){return arguments.length?(M=t,M.focusChart(e),e):M},e.zoomScale=function(t){return arguments.length?(Z=t,e):Z},e.zoomOutRestrict=function(t){return arguments.length?(Q=t,e):Q},e._generateG=function(t){x=void 0===t?e.svg():t;var n=window.location.href.split("#")[0];return A=x.append("g"),b=A.append("g").attr("class","chart-body").attr("transform","translate("+e.margins().left+", "+e.margins().top+")").attr("clip-path","url("+n+"#"+o()+")"),A},e.g=function(t){return arguments.length?(A=t,e):A},e.mouseZoomable=function(t){return arguments.length?(et=t,e):et},e.chartBodyG=function(t){return arguments.length?(b=t,e):b},e.x=function(t){return arguments.length?(_=t,w=_.domain(),e.rescale(),e):_},e.xOriginalDomain=function(){return w},e.xUnits=function(t){return arguments.length?(T=t,e):T},e.xAxis=function(t){return arguments.length?(B=t,e):B},e.elasticX=function(t){return arguments.length?(P=t,e):P},e.xAxisPadding=function(t){return arguments.length?(N=t,e):N},e.xAxisPaddingUnit=function(t){return arguments.length?(H=t,e):H},e.xUnitCount=function(){return void 0===S&&(e.isOrdinal()?S=e.x().domain().length:(S=e.xUnits()(e.x().domain()[0],e.x().domain()[1]))instanceof Array&&(S=S.length)),S},e.useRightYAxis=function(t){return arguments.length?(at!==t&&V&&r.logger.warn("Value of useRightYAxis has been altered, after yAxis was created. You might get unexpected yAxis behavior. Make calls to useRightYAxis sooner in your chart creation process."),at=t,e):at},e.isOrdinal=function(){return e.xUnits()===r.units.ordinal},e._useOuterPadding=function(){return!0},e._ordinalXDomain=function(){return e._computeOrderedGroups(e.data()).map(e.keyAccessor())},e.renderXAxis=function(t){var n=t.select("g.x");n.empty()&&(n=t.append("g").attr("class","axis x").attr("transform","translate("+e.margins().left+","+e._xAxisY()+")"));var i=t.select("text.x-axis-label");i.empty()&&e.xAxisLabel()&&(i=t.append("text").attr("class","x-axis-label").attr("transform","translate("+(e.margins().left+e.xAxisLength()/2)+","+(e.height()-G)+")").attr("text-anchor","middle")),e.xAxisLabel()&&i.text()!==e.xAxisLabel()&&i.text(e.xAxisLabel()),r.transition(n,e.transitionDuration(),e.transitionDelay()).attr("transform","translate("+e.margins().left+","+e._xAxisY()+")").call(B),r.transition(i,e.transitionDuration(),e.transitionDelay()).attr("transform","translate("+(e.margins().left+e.xAxisLength()/2)+","+(e.height()-G)+")")},e._xAxisY=function(){return e.height()-e.margins().bottom},e.xAxisLength=function(){return e.effectiveWidth()},e.xAxisLabel=function(t,n){return arguments.length?(D=t,e.margins().bottom-=G,G=void 0===n?12:n,e.margins().bottom+=G,e):D},e._prepareYAxis=function(n){if(void 0===L||e.elasticY()){void 0===L&&(L=t.scaleLinear());var r=e.yAxisMin()||0,i=e.yAxisMax()||0;L.domain([r,i]).rangeRound([e.yAxisHeight(),0])}L.range([e.yAxisHeight(),0]),V||(V=a()),V.scale(L),e._renderHorizontalGridLinesForAxis(n,L,V)},e.renderYAxisLabel=function(t,n,i,a){a=a||Y;var o=e.g().select("text.y-axis-label."+t+"-label"),l=e.margins().top+e.yAxisHeight()/2;o.empty()&&n&&(o=e.g().append("text").attr("transform","translate("+a+","+l+"),rotate("+i+")").attr("class","y-axis-label "+t+"-label").attr("text-anchor","middle").text(n)),n&&o.text()!==n&&o.text(n),r.transition(o,e.transitionDuration(),e.transitionDelay()).attr("transform","translate("+a+","+l+"),rotate("+i+")")},e.renderYAxisAt=function(t,n,i){var a=e.g().select("g."+t);a.empty()&&(a=e.g().append("g").attr("class","axis "+t).attr("transform","translate("+i+","+e.margins().top+")")),r.transition(a,e.transitionDuration(),e.transitionDelay()).attr("transform","translate("+i+","+e.margins().top+")").call(n)},e.renderYAxis=function(){var t=at?e.width()-e.margins().right:e._yAxisX();e.renderYAxisAt("y",V,t);var n=at?e.width()-Y:Y,r=at?90:-90;e.renderYAxisLabel("y",e.yAxisLabel(),r,n)},e._renderHorizontalGridLinesForAxis=function(t,n,i){var a=t.select("g.horizontal");if(q){var o=i.tickValues()?i.tickValues():n.ticks.apply(n,i.tickArguments());a.empty()&&(a=t.insert("g",":first-child").attr("class",m+" horizontal").attr("transform","translate("+e.margins().left+","+e.margins().top+")"));var l=a.selectAll("line").data(o),u=l.enter().append("line").attr("x1",1).attr("y1",function(t){return n(t)}).attr("x2",e.xAxisLength()).attr("y2",function(t){return n(t)}).attr("opacity",0);r.transition(u,e.transitionDuration(),e.transitionDelay()).attr("opacity",1);var c=u.merge(l);r.transition(c,e.transitionDuration(),e.transitionDelay()).attr("x1",1).attr("y1",function(t){return n(t)}).attr("x2",e.xAxisLength()).attr("y2",function(t){return n(t)}),l.exit().remove()}else a.selectAll("line").remove()},e._yAxisX=function(){return e.useRightYAxis()?e.width()-e.margins().right:e.margins().left},e.yAxisLabel=function(t,n){return arguments.length?(E=t,e.margins().left-=Y,Y=void 0===n?12:n,e.margins().left+=Y,e):E},e.y=function(t){return arguments.length?(L=t,e.rescale(),e):L},e.yAxis=function(t){return arguments.length?(V=t,e):(V||(V=a()),V)},e.elasticY=function(t){return arguments.length?(U=t,e):U},e.renderHorizontalGridLines=function(t){return arguments.length?(q=t,e):q},e.renderVerticalGridLines=function(t){return arguments.length?(W=t,e):W},e.xAxisMin=function(){var n=t.min(e.data(),function(t){return e.keyAccessor()(t)});return r.utils.subtract(n,N,H)},e.xAxisMax=function(){var n=t.max(e.data(),function(t){return e.keyAccessor()(t)});return r.utils.add(n,N,H)},e.yAxisMin=function(){var n=t.min(e.data(),function(t){return e.valueAccessor()(t)});return r.utils.subtract(n,z)},e.yAxisMax=function(){var n=t.max(e.data(),function(t){return e.valueAccessor()(t)});return r.utils.add(n,z)},e.yAxisPadding=function(t){return arguments.length?(z=t,e):z},e.yAxisHeight=function(){return e.effectiveHeight()},e.round=function(t){return arguments.length?(O=t,e):O},e._rangeBandPadding=function(t){return arguments.length?(it=t,e):it},e._outerRangeBandPadding=function(t){return arguments.length?(rt=t,e):rt},r.override(e,"filter",function(t){return arguments.length?(e._filter(t),e.redrawBrush(t,!1),e):e._filter()}),e.brush=function(t){return arguments.length?(I=t,e):I},e.renderBrush=function(t,n){j&&(I.on("start brush end",e._brushing),R=t.append("g").attr("class","brush").attr("transform","translate("+e.margins().left+","+e.margins().top+")"),e.setBrushExtents(),e.createBrushHandlePaths(R,n),e.redrawBrush(e.filter(),n))},e.createBrushHandlePaths=function(t){var n=t.selectAll("path.custom-brush-handle").data([{type:"w"},{type:"e"}]);n=n.enter().append("path").attr("class","custom-brush-handle").merge(n),n.attr("d",e.resizeHandlePath)},e.extendBrush=function(t){return t&&e.round()&&(t[0]=e.round()(t[0]),t[1]=e.round()(t[1])),t},e.brushIsEmpty=function(t){return!t||t[1]<=t[0]},e._brushing=function(){if(t.event.sourceEvent&&(!t.event.sourceEvent.type||-1===["start","brush","end"].indexOf(t.event.sourceEvent.type))){var n=t.event.selection;n&&(n=n.map(e.x().invert)),n=e.extendBrush(n),e.redrawBrush(n,!1);var i=e.brushIsEmpty(n)?null:r.filters.RangedFilter(n[0],n[1]);r.events.trigger(function(){e.applyBrushSelection(i)},r.constants.EVENT_DELAY)}},e.applyBrushSelection=function(t){e.replaceFilter(t),e.redrawGroup()},e.setBrushExtents=function(t){I.extent([[0,0],[e.effectiveWidth(),e.effectiveHeight()]]),R.call(I)},e.redrawBrush=function(t,n){if(j&&R)if(K&&e.setBrushExtents(n),t){var i=[_(t[0]),_(t[1])],a=r.optionalTransition(n,e.transitionDuration(),e.transitionDelay())(R);a.call(I.move,i),a.selectAll("path.custom-brush-handle").attr("display",null).attr("transform",function(e,n){return"translate("+_(t[n])+", 0)"}).attr("d",e.resizeHandlePath)}else R.call(I.move,null),R.selectAll("path.custom-brush-handle").attr("display","none");e.fadeDeselectedArea(t)},e.fadeDeselectedArea=function(t){},e.resizeHandlePath=function(t){t=t.type;var n=+("e"===t),r=n?1:-1,i=e.effectiveHeight()/3;return"M"+.5*r+","+i+"A6,6 0 0 "+n+" "+6.5*r+","+(i+6)+"V"+(2*i-6)+"A6,6 0 0 "+n+" "+.5*r+","+2*i+"ZM"+2.5*r+","+(i+8)+"V"+(2*i-8)+"M"+4.5*r+","+(i+8)+"V"+(2*i-8)},e.clipPadding=function(t){return arguments.length?(nt=t,e):nt},e._preprocessData=function(){},e._doRender=function(){return e.resetSvg(),e._preprocessData(),e._generateG(),l(),u(!0),c(),e},e._doRedraw=function(){return e._preprocessData(),u(!1),l(),e},e._enableMouseZoom=function(){tt=!0;var t=[[0,0],[e.effectiveWidth(),e.effectiveHeight()]];if(J.scaleExtent(Z).extent(t).duration(e.transitionDuration()),Q){var n=Math.max(Z[0],1);J.translateExtent(t).scaleExtent([n,Z[1]])}e.root().call(J),f()},e._disableMouseZoom=function(){e.root().call($)},e.focus=function(t,e){Q&&(t=g(t,w),M&&(t=g(t,M.x().domain()))),s(t,e),f()},e.refocused=function(){return!p(e.x().domain(),w)},e.focusChart=function(t){return arguments.length?(F=t,e.on("filtered",function(t){t.filter()?p(t.filter(),F.filter())||r.events.trigger(function(){F.focus(t.filter(),!0)}):r.events.trigger(function(){F.x().domain(F.xOriginalDomain(),!0)})}),e):F},e.brushOn=function(t){return arguments.length?(j=t,e):j},e.parentBrushOn=function(t){return arguments.length?(X=t,e):X},e.gBrush=function(){return R},e},r.stackMixin=function(e){function n(t,n){var r=t.accessor||e.valueAccessor();t.name=String(t.name||n);var a=t.group.all().map(function(n,i){return{x:e.keyAccessor()(n,i),y:t.hidden?null:r(n,i),data:n,layer:t.name,hidden:t.hidden}});t.domainValues=a.filter(i()),t.values=e.evadeDomainFilter()?a:t.domainValues}function i(){if(!e.x())return r.utils.constant(!0);var t=e.x().domain();return e.isOrdinal()?function(){return!0}:e.elasticX()?function(){return!0}:function(e){return e.x>=t[0]&&e.x<=t[t.length-1]}}function a(t){var e=c.map(r.pluck("name")).indexOf(t)
;return c[e]}function o(){var t=e.data().map(function(t){return t.domainValues});return Array.prototype.concat.apply([],t)}function l(t){return!t.hidden}var u=t.stack(),c=[],s={},d=!1,f=!1;return e.stack=function(t,n,r){if(!arguments.length)return c;arguments.length<=2&&(r=n);var i={group:t};return"string"==typeof n&&(i.name=n),"function"==typeof r&&(i.accessor=r),c.push(i),e},r.override(e,"group",function(t,n,r){return arguments.length?(c=[],s={},e.stack(t,n),r&&e.valueAccessor(r),e._group(t,n)):e._group()}),e.hidableStacks=function(t){return arguments.length?(d=t,e):d},e.hideStack=function(t){var n=a(t);return n&&(n.hidden=!0),e},e.showStack=function(t){var n=a(t);return n&&(n.hidden=!1),e},e.getValueAccessorByIndex=function(t){return c[t].accessor||e.valueAccessor()},e.yAxisMin=function(){var n=t.min(o(),function(t){return t.y<0?t.y+t.y0:t.y0});return r.utils.subtract(n,e.yAxisPadding())},e.yAxisMax=function(){var n=t.max(o(),function(t){return t.y>0?t.y+t.y0:t.y0});return r.utils.add(n,e.yAxisPadding())},e.xAxisMin=function(){var n=t.min(o(),r.pluck("x"));return r.utils.subtract(n,e.xAxisPadding(),e.xAxisPaddingUnit())},e.xAxisMax=function(){var n=t.max(o(),r.pluck("x"));return r.utils.add(n,e.xAxisPadding(),e.xAxisPaddingUnit())},r.override(e,"title",function(t,n){return t?"function"==typeof t?e._title(t):t===e._groupName&&"function"==typeof n?e._title(n):"function"!=typeof n?s[t]||e._title():(s[t]=n,e):e._title()}),e.stackLayout=function(t){return arguments.length?(u=t,e):u},e.evadeDomainFilter=function(t){return arguments.length?(f=t,e):f},e.data(function(){var t=c.filter(l);if(!t.length)return[];t.forEach(n);var r=t[0].values.map(function(e,n){var r={x:e.x};return t.forEach(function(t){r[t.name]=t.values[n].y}),r}),i=t.map(function(t){return t.name});return e.stackLayout().keys(i)(r).forEach(function(e,n){e.forEach(function(e,r){t[n].values[r].y0=e[0],t[n].values[r].y1=e[1]})}),t}),e._ordinalXDomain=function(){var t=o().map(r.pluck("data"));return e._computeOrderedGroups(t).map(e.keyAccessor())},e.colorAccessor(function(t){return this.layer||this.name||t.name||t.layer}),e.legendables=function(){return c.map(function(t,n){return{chart:e,name:t.name,hidden:t.hidden||!1,color:e.getColor.call(t,t.values,n)}})},e.isLegendableHidden=function(t){var e=a(t.name);return!!e&&e.hidden},e.legendToggle=function(t){d&&(e.isLegendableHidden(t)?e.showStack(t.name):e.hideStack(t.name),e.renderGroup())},e},r.capMixin=function(e){var n=1/0,i=!0,a="Others";e.ordering(function(t){return-t.value});var o=function(n,r){var i=t.sum(r,e.valueAccessor()),a=r.map(e.keyAccessor());return i>0?n.concat([{others:a,key:e.othersLabel(),value:i}]):n};return e.cappedKeyAccessor=function(t,n){return t.others?t.key:e.keyAccessor()(t,n)},e.cappedValueAccessor=function(t,n){return t.others?t.value:e.valueAccessor()(t,n)},e.data(function(t){if(n===1/0)return e._computeOrderedGroups(t.all());var r,a=t.all();if(a=e._computeOrderedGroups(a),n)if(i)r=a.slice(n),a=a.slice(0,n);else{var l=Math.max(0,a.length-n);r=a.slice(0,l),a=a.slice(l)}return o?o(a,r):a}),e.cap=function(t){return arguments.length?(n=t,e):n},e.takeFront=function(t){return arguments.length?(i=t,e):i},e.othersLabel=function(t){return arguments.length?(a=t,e):a},e.othersGrouper=function(t){return arguments.length?(o=t,e):o},r.override(e,"onClick",function(t){t.others&&e.filter([t.others]),e._onClick(t)}),e},r.bubbleMixin=function(e){var n=.3,i=10,a=!1,o=!1;e.BUBBLE_NODE_CLASS="node",e.BUBBLE_CLASS="bubble",e.MIN_RADIUS=10,e=r.colorMixin(e),e.renderLabel(!0),e.data(function(n){var r=n.all();if(a){var i=e.radiusValueAccessor();r.sort(function(e,n){return t.descending(i(e),i(n))})}return r});var l=t.scaleLinear().domain([0,100]),u=function(t){return t.r};e.r=function(t){return arguments.length?(l=t,e):l},e.elasticRadius=function(t){return arguments.length?(o=t,e):o},e.calculateRadiusDomain=function(){o&&e.r().domain([e.rMin(),e.rMax()])},e.radiusValueAccessor=function(t){return arguments.length?(u=t,e):u},e.rMin=function(){return t.min(e.data(),function(t){return e.radiusValueAccessor()(t)})},e.rMax=function(){return t.max(e.data(),function(t){return e.radiusValueAccessor()(t)})},e.bubbleR=function(t){var n=e.radiusValueAccessor()(t),r=e.r()(n);return(isNaN(r)||n<=0)&&(r=0),r};var c=function(t){return e.label()(t)},s=function(t){return e.bubbleR(t)>i},d=function(t){return s(t)?1:0},f=function(t){return s(t)?"all":"none"};e._doRenderLabel=function(t){if(e.renderLabel()){var n=t.select("text");n.empty()&&(n=t.append("text").attr("text-anchor","middle").attr("dy",".3em").on("click",e.onClick)),n.attr("opacity",0).attr("pointer-events",f).text(c),r.transition(n,e.transitionDuration(),e.transitionDelay()).attr("opacity",d)}},e.doUpdateLabels=function(t){if(e.renderLabel()){var n=t.select("text").attr("pointer-events",f).text(c);r.transition(n,e.transitionDuration(),e.transitionDelay()).attr("opacity",d)}};var h=function(t){return e.title()(t)};return e._doRenderTitles=function(t){if(e.renderTitle()){t.select("title").empty()&&t.append("title").text(h)}},e.doUpdateTitles=function(t){e.renderTitle()&&t.select("title").text(h)},e.sortBubbleSize=function(t){return arguments.length?(a=t,e):a},e.minRadius=function(t){return arguments.length?(e.MIN_RADIUS=t,e):e.MIN_RADIUS},e.minRadiusWithLabel=function(t){return arguments.length?(i=t,e):i},e.maxBubbleRelativeSize=function(t){return arguments.length?(n=t,e):n},e.fadeDeselectedArea=function(t){e.hasFilter()?e.selectAll("g."+e.BUBBLE_NODE_CLASS).each(function(t){e.isSelectedNode(t)?e.highlightSelected(this):e.fadeDeselected(this)}):e.selectAll("g."+e.BUBBLE_NODE_CLASS).each(function(){e.resetHighlight(this)})},e.isSelectedNode=function(t){return e.hasFilter(t.key)},e.onClick=function(t){var n=t.key;r.events.trigger(function(){e.filter(n),e.redrawGroup()})},e},r.pieChart=function(e,n){function i(){var e=t.min([q.width(),q.height()])/2;S=M&&M<e?M:e;var n,i=x(),o=b();if(t.sum(q.data(),q.valueAccessor())?(n=o(q.data()),F.classed(z,!1)):(n=o([{key:U,value:1,others:[U]}]),F.classed(z,!0)),F){var l=F.select("g."+G).selectAll("g."+H).data(n),u=F.select("g."+V).selectAll("text."+P).data(n);m(l,u),a(l,u,i,n),h(n,i),v(),r.transition(F,q.transitionDuration(),q.transitionDelay()).attr("transform","translate("+q.cx()+","+q.cy()+")")}}function a(t,e,n,r){var i=o(t);l(i,n),u(i),d(e,r,n)}function o(t){return t.enter().append("g").attr("class",function(t,e){return H+" _"+e})}function l(t,e){var n=t.append("path").attr("fill",C).on("click",L).attr("d",function(t,n){return E(t,n,e)}),i=r.transition(n,q.transitionDuration(),q.transitionDelay());i.attrTween&&i.attrTween("d",w)}function u(t){q.renderTitle()&&t.append("title").text(function(t){return q.title()(t.data)})}function c(t,e){q._applyLabelText(t),r.transition(t,q.transitionDuration(),q.transitionDelay()).attr("transform",function(t){return R(t,e)}).attr("text-anchor","middle")}function s(t,e){q.select("g.pie-slice._"+t).classed("highlight",e)}function d(t,e,n){if(q.renderLabel()){c(t.enter().append("text").attr("class",function(t,e){var n=H+" "+P+" _"+e;return N&&(n+=" external"),n}).on("click",L).on("mouseover",function(t,e){s(e,!0)}).on("mouseout",function(t,e){s(e,!1)}),n),N&&X&&f(e,n)}}function f(e,n){var i=F.selectAll("polyline."+H).data(e);i.exit().remove(),i=i.enter().append("polyline").attr("class",function(t,e){return"pie-path _"+e+" "+H}).on("click",L).on("mouseover",function(t,e){s(e,!0)}).on("mouseout",function(t,e){s(e,!1)}).merge(i);var a=t.arc().outerRadius(S-I+N).innerRadius(S-I),o=r.transition(i,q.transitionDuration(),q.transitionDelay());o.attrTween?o.attrTween("points",function(e){var r=this._current||e;r={startAngle:r.startAngle,endAngle:r.endAngle};var i=t.interpolate(r,e);return this._current=i(0),function(t){var e=i(t);return[n.centroid(e),a.centroid(e)]}}):o.attr("points",function(t){return[n.centroid(t),a.centroid(t)]}),o.style("visibility",function(t){return t.endAngle-t.startAngle<1e-4?"hidden":"visible"})}function h(t,e){g(t,e),p(t,e),y(t)}function g(t,e){var n=F.selectAll("g."+H).data(t).select("path").attr("d",function(t,n){return E(t,n,e)}),i=r.transition(n,q.transitionDuration(),q.transitionDelay());i.attrTween&&i.attrTween("d",w),i.attr("fill",C)}function p(t,e){if(q.renderLabel()){c(F.selectAll("text."+P).data(t),e),N&&X&&f(t,e)}}function y(t){q.renderTitle()&&F.selectAll("g."+H).data(t).select("title").text(function(t){return q.title()(t.data)})}function m(t,e){t.exit().remove(),e.exit().remove()}function v(){q.hasFilter()?q.selectAll("g."+H).each(function(t){A(t)?q.highlightSelected(this):q.fadeDeselected(this)}):q.selectAll("g."+H).each(function(){q.resetHighlight(this)})}function x(){return t.arc().outerRadius(S-I).innerRadius(Y)}function A(t){return q.hasFilter(q.cappedKeyAccessor(t.data))}function b(){return t.pie().sort(null).value(q.cappedValueAccessor)}function _(t){var e=t.endAngle-t.startAngle;return isNaN(e)||e<j}function k(t){return 0===q.cappedValueAccessor(t)}function w(e){e.innerRadius=Y;var n=this._current;n=D(n)?{startAngle:0,endAngle:0}:{startAngle:n.startAngle,endAngle:n.endAngle};var r=t.interpolate(n,e);return this._current=r(0),function(t){return E(r(t),0,x())}}function D(t){return!t||isNaN(t.startAngle)||isNaN(t.endAngle)}function C(t,e){return q.getColor(t.data,e)}function L(t,e){F.attr("class")!==z&&q.onClick(t.data,e)}function E(t,e,n){var r=n(t,e);return r.indexOf("NaN")>=0&&(r="M0,0"),r}function R(e,n){var r;return r=N?t.arc().outerRadius(S-I+N).innerRadius(S-I+N).centroid(e):n.centroid(e),isNaN(r[0])||isNaN(r[1])?"translate(0,0)":"translate("+r+")"}function O(e,n){q.selectAll("g.pie-slice").each(function(r){e.name===r.data.key&&t.select(this).classed("highlight",n)})}var S,M,F,B,T,N,H="pie-slice",P="pie-label",G="pie-slice-group",V="pie-label-group",z="empty-chart",U="empty",Y=0,I=0,j=.5,X=!1,q=r.capMixin(r.colorMixin(r.baseMixin({})));return q.colorAccessor(q.cappedKeyAccessor),q.title(function(t){return q.cappedKeyAccessor(t)+": "+q.cappedValueAccessor(t)}),q.slicesCap=q.cap,q.label(q.cappedKeyAccessor),q.renderLabel(!0),q.transitionDuration(350),q.transitionDelay(0),q._doRender=function(){return q.resetSvg(),F=q.svg().append("g").attr("transform","translate("+q.cx()+","+q.cy()+")"),F.append("g").attr("class",G),F.append("g").attr("class",V),i(),q},q._applyLabelText=function(t){t.text(function(t){return!k(t.data)&&!_(t)||A(t)?q.label()(t.data):""})},q.externalRadiusPadding=function(t){return arguments.length?(I=t,q):I},q.innerRadius=function(t){return arguments.length?(Y=t,q):Y},q.radius=function(t){return arguments.length?(M=t,q):M},q.cx=function(t){return arguments.length?(B=t,q):B||q.width()/2},q.cy=function(t){return arguments.length?(T=t,q):T||q.height()/2},q._doRedraw=function(){return i(),q},q.minAngleForLabel=function(t){return arguments.length?(j=t,q):j},q.emptyTitle=function(t){return 0===arguments.length?U:(U=t,q)},q.externalLabels=function(t){return 0===arguments.length?N:(N=t||void 0,q)},q.drawPaths=function(t){return 0===arguments.length?X:(X=t,q)},q.legendables=function(){return q.data().map(function(t,e){var n={name:t.key,data:t.value,others:t.others,chart:q};return n.color=q.getColor(t,e),n})},q.legendHighlight=function(t){O(t,!0)},q.legendReset=function(t){O(t,!1)},q.legendToggle=function(t){q.onClick({key:t.name,others:t.others})},q.anchor(e,n)},r.sunburstChart=function(e,n){function i(){M=M||t.min([U.width(),U.height()])/2;var e,n,i=m();if(t.sum(U.data(),U.valueAccessor())?(n=r.utils.toHierarchy(U.data(),U.valueAccessor()),e=b(n),e.shift(),F.classed(P,!1)):(n=r.utils.toHierarchy([],function(t){return t.value}),e=b(n),F.classed(P,!0)),F){var o=F.selectAll("g."+H).data(e);a(o,i,e),d(e,i),p(o),y()}}function a(t,e,n){var r=o(t);l(r,e),u(r),s(n,e)}function o(t){return t.enter().append("g").attr("class",function(t,e){return H+" _"+e+" "+H+"-level-"+t.depth})}function l(t,e){var n=t.append("path").attr("fill",C).on("click",E).attr("d",function(t,n){return R(t,n,e)}),i=r.transition(n,U.transitionDuration());i.attrTween&&i.attrTween("d",w)}function u(t){U.renderTitle()&&t.append("title").text(function(t){return U.title()(t)})}function c(t,e){r.transition(t,U.transitionDuration()).attr("transform",function(t){return O(t,e)}).attr("text-anchor","middle").text(function(t){return k(t)||_(t)?"":U.label()(t)})}function s(t,e){if(U.renderLabel()){var n=F.selectAll("text."+H).data(t);n.exit().remove();c(n.enter().append("text").attr("class",function(t,e){var n=H+" _"+e;return N&&(n+=" external"),n}).on("click",E),e)}}function d(t,e){f(t,e),h(t,e),g(t)}function f(t,e){var n=F.selectAll("g."+H).data(t).select("path").attr("d",function(t,n){return R(t,n,e)}),i=r.transition(n,U.transitionDuration());i.attrTween&&i.attrTween("d",w),i.attr("fill",C)}function h(t,e){if(U.renderLabel()){c(F.selectAll("text."+H).data(t),e)}}function g(t){U.renderTitle()&&F.selectAll("g."+H).data(t).select("title").text(function(t){return U.title()(t)})}function p(t){t.exit().remove()}function y(){U.hasFilter()?U.selectAll("g."+H).each(function(t){v(t)?U.highlightSelected(this):U.fadeDeselected(this)}):U.selectAll("g."+H).each(function(t){U.resetHighlight(this)})}function m(){return t.arc().startAngle(function(t){return t.x0}).endAngle(function(t){return t.x1}).innerRadius(function(t){return t.data.path&&1===t.data.path.length?V:Math.sqrt(t.y0)}).outerRadius(function(t){return Math.sqrt(t.y1)})}function v(t){return x(t.path)}function x(t){for(var e=0;e<U.filters().length;e++){if(U.filters()[e].isFiltered(t))return!0}return!1}function A(t){for(var e=r.filters.HierarchyFilter(t),n=[],i=0;i<U.filters().length;i++){var a=U.filters()[i];(a.isFiltered(t)||e.isFiltered(a))&&n.push(a)}return n}function b(e){var n=t.hierarchy(e).sum(function(t){return t.children?0:U.cappedValueAccessor(t)}).sort(function(e,n){return t.ascending(e.data.path,n.data.path)});return t.partition().size([2*Math.PI,M*M])(n),n.descendants().map(function(t){return t.key=t.data.key,t.path=t.data.path,t})}function _(t){var e=t.x1-t.x0;return isNaN(e)||e<z}function k(t){return 0===U.cappedValueAccessor(t)}function w(e){e.innerRadius=V;var n=this._current;D(n)&&(n={x:0,y:0,dx:0,dy:0});var r={x:e.x,y:e.y,dx:e.dx,dy:e.dy},i=t.interpolate(n,r);return this._current=i(0),function(t){return R(Object.assign({},e,i(t)),0,m())}}function D(t){return!t||isNaN(t.dx)||isNaN(t.dy)}function C(t,e){return U.getColor(t,e)}function L(t){for(var e=t.path||t.key,n=r.filters.HierarchyFilter(e),i=A(e),a=!1,o=i.length-1;o>=0;o--){var l=i[o];r.utils.arraysIdentical(l,e)&&(a=!0),U.filter(i[o])}r.events.trigger(function(){a||U.filter(n),U.redrawGroup()})}function E(t,e){F.attr("class")!==P&&L(t,e)}function R(t,e,n){var r=n(t,e);return r.indexOf("NaN")>=0&&(r="M0,0"),r}function O(e,n){var r;return r=N?t.svg.arc().outerRadius(M+N).innerRadius(M+N).centroid(e):n.centroid(e),isNaN(r[0])||isNaN(r[1])?"translate(0,0)":"translate("+r+")"}function S(e,n){U.selectAll("g.pie-slice").each(function(r){e.name===r.key&&t.select(this).classed("highlight",n)})}var M,F,B,T,N,H="pie-slice",P="empty-chart",G="empty",V=0,z=.5,U=r.capMixin(r.colorMixin(r.baseMixin({})));return U.colorAccessor(U.cappedKeyAccessor),U.title(function(t){return U.cappedKeyAccessor(t)+": "+U.cappedValueAccessor(t)}),U.label(U.cappedKeyAccessor),U.renderLabel(!0),U.transitionDuration(350),U.filterHandler(function(t,e){return 0===e.length?t.filter(null):t.filterFunction(function(t){for(var n=0;n<e.length;n++){var r=e[n];if(r.isFiltered&&r.isFiltered(t))return!0}return!1}),e}),U._doRender=function(){return U.resetSvg(),F=U.svg().append("g").attr("transform","translate("+U.cx()+","+U.cy()+")"),i(),U},U.innerRadius=function(t){return arguments.length?(V=t,U):V},U.radius=function(t){return arguments.length?(M=t,U):M},U.cx=function(t){return arguments.length?(B=t,U):B||U.width()/2},U.cy=function(t){return arguments.length?(T=t,U):T||U.height()/2},U.minAngleForLabel=function(t){return arguments.length?(z=t,U):z},U.emptyTitle=function(t){return 0===arguments.length?G:(G=t,U)},U.externalLabels=function(t){return 0===arguments.length?N:(N=t||void 0,U)},U._doRedraw=function(){return i(),U},U.onClick=E,U.legendables=function(){return U.data().map(function(t,e){var n={name:t.key,data:t.value,others:t.others,chart:U};return n.color=U.getColor(t,e),n})},U.legendHighlight=function(t){S(t,!0)},U.legendReset=function(t){S(t,!1)},U.legendToggle=function(t){U.onClick({key:t.name,others:t.others})},U.anchor(e,n)},r.barChart=function(e,n){function i(t){return r.utils.safeNumber(Math.abs(p.y()(t.y+t.y0)-p.y()(t.y0)))}function a(t){var e=p.x()(t.x);return m||(e+=f/2),p.isOrdinal()&&void 0!==y&&(e+=y/2),r.utils.safeNumber(e)}function o(t){var e=p.y()(t.y+t.y0);return t.y<0&&(e-=i(t)),r.utils.safeNumber(e-g)}function l(t,e,n){var i=t.selectAll("text.barLabel").data(n.values,r.pluck("x")),l=i.enter().append("text").attr("class","barLabel").attr("text-anchor","middle").attr("x",a).attr("y",o).merge(i);p.isOrdinal()&&(l.on("click",p.onClick),l.attr("cursor","pointer")),r.transition(l,p.transitionDuration(),p.transitionDelay()).attr("x",a).attr("y",o).text(function(t){return p.label()(t)}),r.transition(i.exit(),p.transitionDuration(),p.transitionDelay()).attr("height",0).remove()}function u(t){var e=p.x()(t.x);return m&&(e-=f/2),p.isOrdinal()&&void 0!==y&&(e+=y/2),r.utils.safeNumber(e)}function c(t,e,n){var a=t.selectAll("rect.bar").data(n.values,r.pluck("x")),o=a.enter().append("rect").attr("class","bar").attr("fill",r.pluck("data",p.getColor)).attr("x",u).attr("y",p.yAxisHeight()).attr("height",0),l=o.merge(a);p.renderTitle()&&o.append("title").text(r.pluck("data",p.title(n.name))),p.isOrdinal()&&l.on("click",p.onClick),r.transition(l,p.transitionDuration(),p.transitionDelay()).attr("x",u).attr("y",function(t){var e=p.y()(t.y+t.y0);return t.y<0&&(e-=i(t)),r.utils.safeNumber(e)}).attr("width",f).attr("height",function(t){return i(t)}).attr("fill",r.pluck("data",p.getColor)).select("title").text(r.pluck("data",p.title(n.name))),r.transition(a.exit(),p.transitionDuration(),p.transitionDelay()).attr("x",function(t){return p.x()(t.x)}).attr("width",.9*f).remove()}function s(){if(void 0===f){var t=p.xUnitCount();f=p.isOrdinal()&&void 0===y?Math.floor(p.x().bandwidth()):y?Math.floor((p.xAxisLength()-(t-1)*y)/t):Math.floor(p.xAxisLength()/(1+p.barPadding())/t),(f===1/0||isNaN(f)||f<h)&&(f=h)}}function d(e,n){return function(){var r=t.select(this),i=r.attr("fill")===e;return n?!i:i}}var f,h=1,g=3,p=r.stackMixin(r.coordinateGridMixin({})),y=2,m=!1,v=!1;return r.override(p,"rescale",function(){return p._rescale(),f=void 0,p}),r.override(p,"render",function(){return p.round()&&m&&!v&&r.logger.warn("By default, brush rounding is disabled if bars are centered. See dc.js bar chart API documentation for details."),p._render()}),p.label(function(t){return r.utils.printSingleValue(t.y0+t.y)},!1),p.plotData=function(){var e=p.chartBodyG().selectAll("g.stack").data(p.data());s(),e=e.enter().append("g").attr("class",function(t,e){return"stack _"+e}).merge(e);var n=e.size()-1;e.each(function(e,r){var i=t.select(this);c(i,r,e),p.renderLabel()&&n===r&&l(i,r,e)})},p.fadeDeselectedArea=function(t){var e=p.chartBodyG().selectAll("rect.bar");if(p.isOrdinal())p.hasFilter()?(e.classed(r.constants.SELECTED_CLASS,function(t){return p.hasFilter(t.x)}),e.classed(r.constants.DESELECTED_CLASS,function(t){return!p.hasFilter(t.x)})):(e.classed(r.constants.SELECTED_CLASS,!1),e.classed(r.constants.DESELECTED_CLASS,!1));else if(p.brushOn()||p.parentBrushOn())if(p.brushIsEmpty(t))e.classed(r.constants.DESELECTED_CLASS,!1);else{var n=t[0],i=t[1];e.classed(r.constants.DESELECTED_CLASS,function(t){return t.x<n||t.x>=i})}},p.centerBar=function(t){return arguments.length?(m=t,p):m},r.override(p,"onClick",function(t){p._onClick(t.data)}),p.barPadding=function(t){return arguments.length?(p._rangeBandPadding(t),y=void 0,p):p._rangeBandPadding()},p._useOuterPadding=function(){return void 0===y},p.outerPadding=p._outerRangeBandPadding,p.gap=function(t){return arguments.length?(y=t,p):y},p.extendBrush=function(t){return t&&p.round()&&(!m||v)&&(t[0]=p.round()(t[0]),t[1]=p.round()(t[1])),t},p.alwaysUseRounding=function(t){return arguments.length?(v=t,p):v},p.legendHighlight=function(t){p.isLegendableHidden(t)||p.g().selectAll("rect.bar").classed("highlight",d(t.color)).classed("fadeout",d(t.color,!0))},p.legendReset=function(){p.g().selectAll("rect.bar").classed("highlight",!1).classed("fadeout",!1)},r.override(p,"xAxisMax",function(){var t=this._xAxisMax();if("resolution"in p.xUnits()){t+=p.xUnits().resolution}return t}),p.anchor(e,n)},r.lineChart=function(e,n){function i(t,e){return C.getColor.call(t,t.values,e)}function a(){var e=null;if(M)return M;if("function"==typeof F)e=F;else{e={linear:t.curveLinear,"linear-closed":t.curveLinearClosed,step:t.curveStep,"step-before":t.curveStepBefore,"step-after":t.curveStepAfter,basis:t.curveBasis,"basis-open":t.curveBasisOpen,"basis-closed":t.curveBasisClosed,bundle:t.curveBundle,cardinal:t.curveCardinal,"cardinal-open":t.curveCardinalOpen,"cardinal-closed":t.curveCardinalClosed,monotone:t.curveMonotoneX}[F]}return e||(e=t.curveLinear),null!==B&&("function"!=typeof e.tension?r.logger.warn("tension was specified but the curve/interpolate does not support it."):e=e.tension(B)),e}function o(e,n){var o=t.line().x(function(t){return C.x()(t.x)}).y(function(t){return C.y()(t.y+t.y0)}).curve(a());x&&o.defined(x);var l=e.append("path").attr("class","line").attr("stroke",i);A&&l.attr("stroke-dasharray",A),r.transition(n.select("path.line"),C.transitionDuration(),C.transitionDelay()).attr("stroke",i).attr("d",function(t){return u(o(t.values))})}function l(e,n){if(L){var o=t.area().x(function(t){return C.x()(t.x)}).y1(function(t){return C.y()(t.y+t.y0)}).y0(function(t){return C.y()(t.y0)}).curve(a());x&&o.defined(x),e.append("path").attr("class","area").attr("fill",i).attr("d",function(t){return u(o(t.values))}),r.transition(n.select("path.area"),C.transitionDuration(),C.transitionDelay()).attr("fill",i).attr("d",function(t){return u(o(t.values))})}}function u(t){return!t||t.indexOf("NaN")>=0?"M0,0":t}function c(e,n){if("always"===C.xyTipsOn()||!C.brushOn()&&!C.parentBrushOn()&&C.xyTipsOn()){var i=b+"-list",a=e.select("g."+i);a.empty()&&(a=e.append("g").attr("class",i)),n.each(function(e,n){var i=e.values;x&&(i=i.filter(x));var o=a.select("g."+b+"._"+n);o.empty()&&(o=a.append("g").attr("class",b+" _"+n)),d(o);var l=o.selectAll("circle."+_).data(i,r.pluck("x")),u=l.enter().append("circle").attr("class",_).attr("cx",function(t){return r.utils.safeNumber(C.x()(t.x))}).attr("cy",function(t){return r.utils.safeNumber(C.y()(t.y+t.y0))}).attr("r",g()).style("fill-opacity",O).style("stroke-opacity",S).attr("fill",C.getColor).on("mousemove",function(){var e=t.select(this);f(e),h(e,o)}).on("mouseout",function(){p(t.select(this)),y(o)}).merge(l);u.call(m,e),r.transition(u,C.transitionDuration()).attr("cx",function(t){return r.utils.safeNumber(C.x()(t.x))}).attr("cy",function(t){return r.utils.safeNumber(C.y()(t.y+t.y0))}).attr("fill",C.getColor),l.exit().remove()})}}function s(e){e.each(function(e,n){var i=t.select(this),a=i.selectAll("text.lineLabel").data(e.values,r.pluck("x")),o=a.enter().append("text").attr("class","lineLabel").attr("text-anchor","middle").merge(a);r.transition(o,C.transitionDuration()).attr("x",function(t){return r.utils.safeNumber(C.x()(t.x))}).attr("y",function(t){var e=C.y()(t.y+t.y0)-D;return r.utils.safeNumber(e)}).text(function(t){return C.label()(t)}),r.transition(a.exit(),C.transitionDuration()).attr("height",0).remove()})}function d(t){(t.select("path."+k).empty()?t.append("path").attr("class",k):t.select("path."+k)).style("display","none").attr("stroke-dasharray","5,5"),(t.select("path."+w).empty()?t.append("path").attr("class",w):t.select("path."+w)).style("display","none").attr("stroke-dasharray","5,5")}function f(t){return t.style("fill-opacity",.8),t.style("stroke-opacity",.8),t.attr("r",E),t}function h(t,e){var n=t.attr("cx"),r=t.attr("cy"),i=C._yAxisX()-C.margins().left,a="M"+i+" "+r+"L"+n+" "+r,o="M"+n+" "+C.yAxisHeight()+"L"+n+" "+r;e.select("path."+k).style("display","").attr("d",a),e.select("path."+w).style("display","").attr("d",o)}function g(){return R||E}function p(t){t.style("fill-opacity",O).style("stroke-opacity",S).attr("r",g())}function y(t){t.select("path."+k).style("display","none"),t.select("path."+w).style("display","none")}function m(t,e){C.renderTitle()&&(t.select("title").remove(),t.append("title").text(r.pluck("data",C.title(e.name))))}function v(e,n,r){return function(){var i=t.select(this),a=i.attr("stroke")===e&&i.attr("stroke-dasharray")===(n instanceof Array?n.join(","):null)||i.attr("fill")===e;return r?!a:a}}var x,A,b="dc-tooltip",_="dot",k="yRef",w="xRef",D=3,C=r.stackMixin(r.coordinateGridMixin({})),L=!1,E=5,R=null,O=1e-6,S=1e-6,M=null,F=null,B=null,T=!0;return C.transitionDuration(500),C.transitionDelay(0),C._rangeBandPadding(1),C.plotData=function(){var t=C.chartBodyG(),e=t.select("g.stack-list");e.empty()&&(e=t.append("g").attr("class","stack-list"));var n=e.selectAll("g.stack").data(C.data()),r=n.enter().append("g").attr("class",function(t,e){return"stack _"+e});n=r.merge(n),o(r,n),l(r,n),c(t,n),C.renderLabel()&&s(n)},C.curve=function(t){return arguments.length?(M=t,C):M},C.interpolate=r.logger.deprecate(function(t){return arguments.length?(F=t,C):F},"dc.lineChart.interpolate has been deprecated since version 3.0 use dc.lineChart.curve instead"),C.tension=r.logger.deprecate(function(t){return arguments.length?(B=t,C):B},"dc.lineChart.tension has been deprecated since version 3.0 use dc.lineChart.curve instead"),C.defined=function(t){return arguments.length?(x=t,C):x},C.dashStyle=function(t){return arguments.length?(A=t,C):A},C.renderArea=function(t){return arguments.length?(L=t,C):L},C.label(function(t){return r.utils.printSingleValue(t.y0+t.y)},!1),C.xyTipsOn=function(t){return arguments.length?(T=t,C):T},C.dotRadius=function(t){return arguments.length?(E=t,C):E},C.renderDataPoints=function(t){return arguments.length?(t?(O=t.fillOpacity||.8,S=t.strokeOpacity||.8,R=t.radius||2):(O=1e-6,S=1e-6,R=null),C):{fillOpacity:O,strokeOpacity:S,radius:R}},C.legendHighlight=function(t){C.isLegendableHidden(t)||C.g().selectAll("path.line, path.area").classed("highlight",v(t.color,t.dashstyle)).classed("fadeout",v(t.color,t.dashstyle,!0))},C.legendReset=function(){C.g().selectAll("path.line, path.area").classed("highlight",!1).classed("fadeout",!1)},r.override(C,"legendables",function(){var t=C._legendables();return A?t.map(function(t){return t.dashstyle=A,t}):t}),C.anchor(e,n)},r.dataCount=function(e,n){var i=t.format(",d"),a=r.baseMixin({}),o={some:"",all:""};return a.html=function(t){return arguments.length?(t.all&&(o.all=t.all),t.some&&(o.some=t.some),a):o},a.formatNumber=function(t){return arguments.length?(i=t,a):i},a._doRender=function(){var t=a.dimension().size(),e=a.group().value(),n=i(t),r=i(e);return t===e&&""!==o.all?a.root().html(o.all.replace("%total-count",n).replace("%filter-count",r)):""!==o.some?a.root().html(o.some.replace("%total-count",n).replace("%filter-count",r)):(a.selectAll(".total-count").text(n),a.selectAll(".filter-count").text(r)),a},a._doRedraw=function(){return a._doRender()},a.anchor(e,n)},r.dataTable=function(e,n){function i(){var t=!0;if(p.forEach(function(e){t&="function"==typeof e}),!t){var e=h.selectAll("thead").data([0]);e.exit().remove(),e=e.enter().append("thead").merge(e);var n=e.selectAll("tr").data([0]);n.exit().remove(),n=n.enter().append("tr").merge(n);var r=n.selectAll("th").data(p);r.exit().remove(),r.enter().append("th").merge(r).attr("class",f).html(function(t){return h._doColumnHeaderFormat(t)})}var i=h.root().selectAll("tbody").data(a(),function(t){return h.keyAccessor()(t)}),o=i.enter().append("tbody");return!0===x&&o.append("tr").attr("class",d).append("td").attr("class",u).attr("colspan",p.length).html(function(t){return h.keyAccessor()(t)}),i.exit().remove(),o}function a(){var e;return e=m===t.ascending?h.dimension().bottom(g):h.dimension().top(g),t.nest().key(h.group()).sortKeys(m).entries(e.sort(function(t,e){return m(y(t),y(e))}).slice(v,l))}function o(t){var e=t.order().selectAll("tr."+c).data(function(t){return t.values}),n=e.enter().append("tr").attr("class",c);return p.forEach(function(t,e){n.append("td").attr("class",s+" _"+e).html(function(e){return h._doColumnValueFormat(t,e)})}),e.exit().remove(),e}var l,u="dc-table-label",c="dc-table-row",s="dc-table-column",d="dc-table-group",f="dc-table-head",h=r.baseMixin({}),g=25,p=[],y=function(t){return t},m=t.ascending,v=0,x=!0;return h._doRender=function(){return h.selectAll("tbody").remove(),o(i()),h},h._doColumnValueFormat=function(t,e){return"function"==typeof t?t(e):"string"==typeof t?e[t]:t.format(e)},h._doColumnHeaderFormat=function(t){return"function"==typeof t?h._doColumnHeaderFnToString(t):"string"==typeof t?h._doColumnHeaderCapitalize(t):String(t.label)},h._doColumnHeaderCapitalize=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},h._doColumnHeaderFnToString=function(t){var e=String(t),n=e.indexOf("return ");if(n>=0){var r=e.lastIndexOf(";");if(r>=0){e=e.substring(n+7,r);e.indexOf("numberFormat")>=0&&(e=e.replace("numberFormat",""))}}return e},h._doRedraw=function(){return h._doRender()},h.size=function(t){return arguments.length?(g=t,h):g},h.beginSlice=function(t){return arguments.length?(v=t,h):v},h.endSlice=function(t){return arguments.length?(l=t,h):l},h.columns=function(t){return arguments.length?(p=t,h):p},h.sortBy=function(t){return arguments.length?(y=t,h):y},h.order=function(t){return arguments.length?(m=t,h):m},h.showGroups=function(t){return arguments.length?(x=t,h):x},h.anchor(e,n)},r.dataGrid=function(e,n){function i(){var t=s.root().selectAll("div."+c).data(a(),function(t){return s.keyAccessor()(t)}),e=t.enter().append("div").attr("class",c);return y&&e.html(function(t){return y(t)}),t.exit().remove(),e}function a(){var e=s.dimension().top(d);return t.nest().key(s.group()).sortKeys(g).entries(e.sort(function(t,e){return g(h(t),h(e))}).slice(p,l))}function o(t){var e=t.order().selectAll("div."+u).data(function(t){return t.values});return e.exit().remove(),e=e.enter().append("div").attr("class",u).html(function(t){return f(t)}).merge(e)}var l,u="dc-grid-item",c="dc-grid-top",s=r.baseMixin({}),d=999,f=function(t){return"you need to provide an html() handling param:  "+JSON.stringify(t)},h=function(t){return t},g=t.ascending,p=0,y=function(t){return"<div class='dc-grid-group'><h1 class='dc-grid-label'>"+s.keyAccessor()(t)+"</h1></div>"};return s._doRender=function(){return s.selectAll("div."+c).remove(),o(i()),s},s._doRedraw=function(){return s._doRender()},s.beginSlice=function(t){return arguments.length?(p=t,s):p},s.endSlice=function(t){return arguments.length?(l=t,s):l},s.size=function(t){return arguments.length?(d=t,s):d},s.html=function(t){return arguments.length?(f=t,s):f},s.htmlGroup=function(t){return arguments.length?(y=t,s):y},s.sortBy=function(t){return arguments.length?(h=t,s):h},s.order=function(t){return arguments.length?(g=t,s):g},s.anchor(e,n)},r.bubbleChart=function(t,e){function n(t){var e=t.enter().append("g");return e.attr("class",u.BUBBLE_NODE_CLASS).attr("transform",c).append("circle").attr("class",function(t,e){return u.BUBBLE_CLASS+" _"+e}).on("click",u.onClick).attr("fill",u.getColor).attr("r",0),t=e.merge(t),r.transition(t,u.transitionDuration(),u.transitionDelay()).select("circle."+u.BUBBLE_CLASS).attr("r",function(t){return u.bubbleR(t)}).attr("opacity",function(t){return u.bubbleR(t)>0?1:0}),u._doRenderLabel(e),u._doRenderTitles(e),t}function i(t){r.transition(t,u.transitionDuration(),u.transitionDelay()).attr("transform",c).select("circle."+u.BUBBLE_CLASS).attr("fill",u.getColor).attr("r",function(t){return u.bubbleR(t)}).attr("opacity",function(t){return u.bubbleR(t)>0?1:0}),u.doUpdateLabels(t),u.doUpdateTitles(t)}function a(t){t.exit().remove()}function o(t){
var e=u.x()(u.keyAccessor()(t));return!isNaN(e)&&isFinite(e)||(e=0),e}function l(t){var e=u.y()(u.valueAccessor()(t));return!isNaN(e)&&isFinite(e)||(e=0),e}var u=r.bubbleMixin(r.coordinateGridMixin({}));u.transitionDuration(750),u.transitionDelay(0);var c=function(t){return"translate("+o(t)+","+l(t)+")"};return u.plotData=function(){u.calculateRadiusDomain(),u.r().range([u.MIN_RADIUS,u.xAxisLength()*u.maxBubbleRelativeSize()]);var t=u.data(),e=u.chartBodyG().selectAll("g."+u.BUBBLE_NODE_CLASS).data(t,function(t){return t.key});u.sortBubbleSize()&&e.order(),e=n(e),i(e),a(e),u.fadeDeselectedArea(u.filter())},u.renderBrush=function(){},u.redrawBrush=function(t,e){u.fadeDeselectedArea(t)},u.anchor(t,e)},r.compositeChart=function(e,n){function i(t,e){var n,r,i,o,l;return t&&(n=f(),r=p()),e&&(i=h(),o=y()),b.alignYAxes()&&t&&e&&(l=a(n,r,i,o)),l||{lyAxisMin:n,lyAxisMax:r,ryAxisMin:i,ryAxisMax:o}}function a(t,e,n,r){var i=(r-n)/(e-t);return{lyAxisMin:Math.min(t,n/i),lyAxisMax:Math.max(e,r/i),ryAxisMin:Math.min(n,t*i),ryAxisMax:Math.max(r,e*i)}}function o(e){var n=void 0===b.rightY()||b.elasticY(),r=n||b.resizing();void 0===b.rightY()&&b.rightY(t.scaleLinear()),n&&b.rightY().domain([e.ryAxisMin,e.ryAxisMax]),r&&b.rightY().rangeRound([b.yAxisHeight(),0]),b.rightY().range([b.yAxisHeight(),0]),b.rightYAxis(b.rightYAxis().scale(b.rightY()))}function l(e){var n=void 0===b.y()||b.elasticY(),r=n||b.resizing();void 0===b.y()&&b.y(t.scaleLinear()),n&&b.y().domain([e.lyAxisMin,e.lyAxisMax]),r&&b.y().rangeRound([b.yAxisHeight(),0]),b.y().range([b.yAxisHeight(),0]),b.yAxis(b.yAxis().scale(b.y()))}function u(t,e){t._generateG(b.g()),t.g().attr("class",A+" _"+e)}function c(){return _.filter(function(t){return!t.useRightYAxis()})}function s(){return _.filter(function(t){return t.useRightYAxis()})}function d(t){return t.map(function(t){return t.yAxisMin()})}function f(){return t.min(d(c()))}function h(){return t.min(d(s()))}function g(t){return t.map(function(t){return t.yAxisMax()})}function p(){return r.utils.add(t.max(g(c())),b.yAxisPadding())}function y(){return r.utils.add(t.max(g(s())),b.yAxisPadding())}function m(){return _.map(function(t){return t.xAxisMin()})}function v(){return _.map(function(t){return t.xAxisMax()})}var x,A="sub",b=r.coordinateGridMixin({}),_=[],k={},w=!1,D=!0,C=!1,L=t.axisRight(),E=0,R=12,O=!1;return b._mandatoryAttributes([]),b.transitionDuration(500),b.transitionDelay(0),r.override(b,"_generateG",function(){for(var t=this.__generateG(),e=0;e<_.length;++e){var n=_[e];u(n,e),n.dimension()||n.dimension(b.dimension()),n.group()||n.group(b.group()),n.chartGroup(b.chartGroup()),n.svg(b.svg()),n.xUnits(b.xUnits()),n.transitionDuration(b.transitionDuration(),b.transitionDelay()),n.parentBrushOn(b.brushOn()),n.brushOn(!1),n.renderTitle(b.renderTitle()),n.elasticX(b.elasticX())}return t}),b.applyBrushSelection=function(t){b.replaceFilter(t);for(var e=0;e<_.length;++e)_[e].replaceFilter(t);b.redrawGroup()},b._prepareYAxis=function(){var t=0!==c().length,e=0!==s().length,n=i(t,e);t&&l(n),e&&o(n),c().length>0&&!O?b._renderHorizontalGridLinesForAxis(b.g(),b.y(),b.yAxis()):s().length>0&&b._renderHorizontalGridLinesForAxis(b.g(),x,L)},b.renderYAxis=function(){0!==c().length&&(b.renderYAxisAt("y",b.yAxis(),b.margins().left),b.renderYAxisLabel("y",b.yAxisLabel(),-90)),0!==s().length&&(b.renderYAxisAt("yr",b.rightYAxis(),b.width()-b.margins().right),b.renderYAxisLabel("yr",b.rightYAxisLabel(),90,b.width()-R))},b.plotData=function(){for(var t=0;t<_.length;++t){var e=_[t];e.g()||u(e,t),w&&e.colors(b.colors()),e.x(b.x()),e.xAxis(b.xAxis()),e.useRightYAxis()?(e.y(b.rightY()),e.yAxis(b.rightYAxis())):(e.y(b.y()),e.yAxis(b.yAxis())),e.plotData(),e._activateRenderlets()}},b.useRightAxisGridLines=function(t){return arguments?(O=t,b):O},b.childOptions=function(t){return arguments.length?(k=t,_.forEach(function(t){t.options(k)}),b):k},b.fadeDeselectedArea=function(t){if(b.brushOn())for(var e=0;e<_.length;++e){var n=_[e];n.fadeDeselectedArea(t)}},b.rightYAxisLabel=function(t,e){return arguments.length?(E=t,b.margins().right-=R,R=void 0===e?12:e,b.margins().right+=R,b):E},b.compose=function(t){return _=t,_.forEach(function(t){t.height(b.height()),t.width(b.width()),t.margins(b.margins()),D&&t.title(b.title()),t.options(k)}),b},b.children=function(){return _},b.shareColors=function(t){return arguments.length?(w=t,b):w},b.shareTitle=function(t){return arguments.length?(D=t,b):D},b.rightY=function(t){return arguments.length?(x=t,b.rescale(),b):x},b.alignYAxes=function(t){return arguments.length?(C=t,b.rescale(),b):C},delete b.yAxisMin,delete b.yAxisMax,r.override(b,"xAxisMin",function(){return r.utils.subtract(t.min(m()),b.xAxisPadding(),b.xAxisPaddingUnit())}),r.override(b,"xAxisMax",function(){return r.utils.add(t.max(v()),b.xAxisPadding(),b.xAxisPaddingUnit())}),b.legendables=function(){return _.reduce(function(t,e){return w&&e.colors(b.colors()),t.push.apply(t,e.legendables()),t},[])},b.legendHighlight=function(t){for(var e=0;e<_.length;++e){_[e].legendHighlight(t)}},b.legendReset=function(t){for(var e=0;e<_.length;++e){_[e].legendReset(t)}},b.legendToggle=function(){console.log("composite should not be getting legendToggle itself")},b.rightYAxis=function(t){return arguments.length?(L=t,b):L},b.anchor(e,n)},r.seriesChart=function(e,n){function i(e,n){return t.ascending(u.keyAccessor()(e),u.keyAccessor()(n))}function a(t){c[t].g()&&c[t].g().remove(),delete c[t]}function o(){Object.keys(c).map(a),c={}}var l,u=r.compositeChart(e,n),c={},s=r.lineChart,d=t.ascending,f=i;return u._mandatoryAttributes().push("seriesAccessor","chart"),u.shareColors(!0),u._preprocessData=function(){var e,i=[],o=t.nest().key(l);d&&o.sortKeys(d),f&&o.sortValues(f);var h=o.entries(u.data()),g=h.map(function(t,a){var o=c[t.key]||s.call(u,u,n,t.key,a);return c[t.key]||(e=!0),c[t.key]=o,i.push(t.key),o.dimension(u.dimension()).group({all:"function"==typeof t.values?t.values:r.utils.constant(t.values)},t.key).keyAccessor(u.keyAccessor()).valueAccessor(u.valueAccessor()).brushOn(!1)});Object.keys(c).filter(function(t){return-1===i.indexOf(t)}).forEach(function(t){a(t),e=!0}),u._compose(g),e&&u.legend()&&u.legend().render()},u.chart=function(t){return arguments.length?(s=t,o(),u):s},u.seriesAccessor=function(t){return arguments.length?(l=t,o(),u):l},u.seriesSort=function(t){return arguments.length?(d=t,o(),u):d},u.valueSort=function(t){return arguments.length?(f=t,o(),u):f},u._compose=u.compose,delete u.compose,u},r.geoChoroplethChart=function(e,n){function i(t){var e=a();if(o(t)){var n=l(t);h(n,t,e),g(n,t,e)}}function a(){for(var t={},e=p.data(),n=0;n<e.length;++n)t[p.keyAccessor()(e[n])]=p.valueAccessor()(e[n]);return t}function o(t){return f(t).keyAccessor}function l(t){return p.svg().selectAll(u(t)).classed("selected",function(e){return c(t,e)}).classed("deselected",function(e){return s(t,e)}).attr("class",function(e){var n=f(t).name,i=r.utils.nameToId(f(t).keyAccessor(e)),a=n+" "+i;return c(t,e)&&(a+=" selected"),s(t,e)&&(a+=" deselected"),a})}function u(t){return"g.layer"+t+" g."+f(t).name}function c(t,e){return p.hasFilter()&&p.hasFilter(d(t,e))}function s(t,e){return p.hasFilter()&&!p.hasFilter(d(t,e))}function d(t,e){return f(t).keyAccessor(e)}function f(t){return x[t]}function h(e,n,i){var a=e.select("path").attr("fill",function(){var e=t.select(this).attr("fill");return e||"none"}).on("click",function(t){return p.onClick(t,n)});r.transition(a,p.transitionDuration(),p.transitionDelay()).attr("fill",function(t,e){return p.getColor(i[f(n).keyAccessor(t)],e)})}function g(t,e,n){p.renderTitle()&&t.selectAll("title").text(function(t){var r=d(e,t),i=n[r];return p.title()({key:r,value:i})})}var p=r.colorMixin(r.baseMixin({}));p.colorAccessor(function(t){return t||0});var y,m,v=t.geoPath(),x=[];p._doRender=function(){p.resetSvg();for(var t=0;t<x.length;++t){var e=p.svg().append("g").attr("class","layer"+t),n=e.selectAll("g."+f(t).name).data(f(t).data);n=n.enter().append("g").attr("class",f(t).name).merge(n),n.append("path").attr("fill","white").attr("d",A()),n.append("title"),i(t)}y=!1},p.onClick=function(t,e){var n=f(e).keyAccessor(t);r.events.trigger(function(){p.filter(n),p.redrawGroup()})},p._doRedraw=function(){for(var t=0;t<x.length;++t)i(t),y&&p.svg().selectAll("g."+f(t).name+" path").attr("d",A());y=!1},p.overlayGeoJson=function(t,e,n){for(var r=0;r<x.length;++r)if(x[r].name===e)return x[r].data=t,x[r].keyAccessor=n,p;return x.push({name:e,data:t,keyAccessor:n}),p},p.projection=function(t){return arguments.length?(m=t,y=!0,p):m};var A=function(){return void 0===m?(r.logger.warn("choropleth projection default of geoAlbers is deprecated, in next version projection will need to be set explicitly"),v.projection(t.geoAlbersUsa())):v.projection(m)};return p.geoJsons=function(){return x},p.geoPath=function(){return v},p.removeGeoJson=function(t){for(var e=[],n=0;n<x.length;++n){var r=x[n];r.name!==t&&e.push(r)}return x=e,p},p.anchor(e,n)},r.bubbleOverlay=function(e,n){function i(){return c=h.select("g."+s),c.empty()&&(c=h.svg().append("g").attr("class",s)),c}function a(){var t=o();h.calculateRadiusDomain(),g.forEach(function(e){var n=l(e,t),i=n.select("circle."+f);i.empty()&&(i=n.append("circle").attr("class",f).attr("r",0).attr("fill",h.getColor).on("click",h.onClick)),r.transition(i,h.transitionDuration(),h.transitionDelay()).attr("r",function(t){return h.bubbleR(t)}),h._doRenderLabel(n),h._doRenderTitles(n)})}function o(){var t={};return h.data().forEach(function(e){t[h.keyAccessor()(e)]=e}),t}function l(t,e){var n=d+" "+r.utils.nameToId(t.name),i=c.select("g."+r.utils.nameToId(t.name));return i.empty()&&(i=c.append("g").attr("class",n).attr("transform","translate("+t.x+","+t.y+")")),i.datum(e[t.name]),i}function u(){var t=o();h.calculateRadiusDomain(),g.forEach(function(e){var n=l(e,t),i=n.select("circle."+f);r.transition(i,h.transitionDuration(),h.transitionDelay()).attr("r",function(t){return h.bubbleR(t)}).attr("fill",h.getColor),h.doUpdateLabels(n),h.doUpdateTitles(n)})}var c,s="bubble-overlay",d="node",f="bubble",h=r.bubbleMixin(r.baseMixin({})),g=[];return h.transitionDuration(750),h.transitionDelay(0),h.radiusValueAccessor(function(t){return t.value}),h.point=function(t,e,n){return g.push({name:t,x:e,y:n}),h},h._doRender=function(){return c=i(),h.r().range([h.MIN_RADIUS,h.width()*h.maxBubbleRelativeSize()]),a(),h.fadeDeselectedArea(h.filter()),h},h._doRedraw=function(){return u(),h.fadeDeselectedArea(h.filter()),h},h.debug=function(e){if(e){var n=h.select("g."+r.constants.DEBUG_GROUP_CLASS);n.empty()&&(n=h.svg().append("g").attr("class",r.constants.DEBUG_GROUP_CLASS));var i=n.append("text").attr("x",10).attr("y",20);n.append("rect").attr("width",h.width()).attr("height",h.height()).on("mousemove",function(){var e=t.mouse(n.node()),r=e[0]+", "+e[1];i.text(r)})}else h.selectAll(".debug").remove();return h},h.anchor(e,n),h},r.rowChart=function(e,n){function i(){if(!x||A){var e=t.extent(b,M.cappedValueAccessor);e[0]>0&&(e[0]=0),e[1]<0&&(e[1]=0),x=t.scaleLinear().domain(e).range([0,M.effectiveWidth()])}F.scale(x)}function a(){var t=v.select("g.axis");i(),t.empty()&&(t=v.append("g").attr("class","axis")),t.attr("transform","translate(0, "+M.effectiveHeight()+")"),r.transition(t,M.transitionDuration(),M.transitionDelay()).call(F)}function o(){v.selectAll("g.tick").select("line.grid-line").remove(),v.selectAll("g.tick").append("line").attr("class","grid-line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",function(){return-M.effectiveHeight()})}function l(){b=M.data(),a(),o();var t=v.selectAll("g."+R).data(b);c(t),t=u(t).merge(t),d(t)}function u(t){var e=t.enter().append("g").attr("class",function(t,e){return R+" _"+e});return e.append("rect").attr("width",0),h(e),e}function c(t){t.exit().remove()}function s(){var t=x(0);return t===-1/0||t!==t?x(1):t}function d(t){var e,n=b.length;e=E||(M.effectiveHeight()-(n+1)*L)/n,w||(k=e/2);var i=t.attr("transform",function(t,n){return"translate(0,"+((n+1)*L+n*e)+")"}).select("rect").attr("height",e).attr("fill",M.getColor).on("click",p).classed("deselected",function(t){return!!M.hasFilter()&&!m(t)}).classed("selected",function(t){return!!M.hasFilter()&&m(t)});r.transition(i,M.transitionDuration(),M.transitionDelay()).attr("width",function(t){return Math.abs(s()-x(M.valueAccessor()(t)))}).attr("transform",y),f(t),g(t)}function f(t){M.renderTitle()&&(t.select("title").remove(),t.append("title").text(M.title()))}function h(t){M.renderLabel()&&t.append("text").on("click",p),M.renderTitleLabel()&&t.append("text").attr("class",O).on("click",p)}function g(t){if(M.renderLabel()){var e=t.select("text").attr("x",_).attr("y",k).attr("dy",D).on("click",p).attr("class",function(t,e){return R+" _"+e}).text(function(t){return M.label()(t)});r.transition(e,M.transitionDuration(),M.transitionDelay()).attr("transform",y)}if(M.renderTitleLabel()){var n=t.select("."+O).attr("x",M.effectiveWidth()-C).attr("y",k).attr("dy",D).attr("text-anchor","end").on("click",p).attr("class",function(t,e){return O+" _"+e}).text(function(t){return M.title()(t)});r.transition(n,M.transitionDuration(),M.transitionDelay()).attr("transform",y)}}function p(t){M.onClick(t)}function y(t){var e=x(M.cappedValueAccessor(t)),n=s();return"translate("+(e>n?n:e)+",0)"}function m(t){return M.hasFilter(M.cappedKeyAccessor(t))}var v,x,A,b,_=10,k=15,w=!1,D="0.35em",C=2,L=5,E=!1,R="row",O="titlerow",S=!1,M=r.capMixin(r.marginMixin(r.colorMixin(r.baseMixin({})))),F=t.axisBottom();return M.rowsCap=M.cap,M._doRender=function(){return M.resetSvg(),v=M.svg().append("g").attr("transform","translate("+M.margins().left+","+M.margins().top+")"),l(),M},M.title(function(t){return M.cappedKeyAccessor(t)+": "+M.cappedValueAccessor(t)}),M.label(M.cappedKeyAccessor),M.x=function(t){return arguments.length?(x=t,M):x},M.renderTitleLabel=function(t){return arguments.length?(S=t,M):S},M._doRedraw=function(){return l(),M},M.xAxis=function(t){return arguments.length?(F=t,this):F},M.fixedBarHeight=function(t){return arguments.length?(E=t,M):E},M.gap=function(t){return arguments.length?(L=t,M):L},M.elasticX=function(t){return arguments.length?(A=t,M):A},M.labelOffsetX=function(t){return arguments.length?(_=t,M):_},M.labelOffsetY=function(t){return arguments.length?(k=t,w=!0,M):k},M.titleLabelOffsetX=function(t){return arguments.length?(C=t,M):C},M.anchor(e,n)},r.legend=function(){function t(){return c+u}var e,n,i,a={},o=0,l=0,u=12,c=5,s=!1,d=560,f=70,h=!1,g=r.pluck("name");return a.parent=function(t){return arguments.length?(e=t,a):e},a.render=function(){e.svg().select("g.dc-legend").remove(),i=e.svg().append("g").attr("class","dc-legend").attr("transform","translate("+o+","+l+")");var a=e.legendables();void 0!==n&&(a=a.slice(0,n));var p=i.selectAll("g.dc-legend-item").data(a).enter().append("g").attr("class","dc-legend-item").on("mouseover",function(t){e.legendHighlight(t)}).on("mouseout",function(t){e.legendReset(t)}).on("click",function(t){t.chart.legendToggle(t)});i.selectAll("g.dc-legend-item").classed("fadeout",function(t){return t.chart.isLegendableHidden(t)}),a.some(r.pluck("dashstyle"))?p.append("line").attr("x1",0).attr("y1",u/2).attr("x2",u).attr("y2",u/2).attr("stroke-width",2).attr("stroke-dasharray",r.pluck("dashstyle")).attr("stroke",r.pluck("color")):p.append("rect").attr("width",u).attr("height",u).attr("fill",function(t){return t?t.color:"blue"}),p.append("text").text(g).attr("x",u+2).attr("y",function(){return u/2+(this.clientHeight?this.clientHeight:13)/2-2});var y=0,m=0;p.attr("transform",function(e,n){if(s){var r=!0===h?this.getBBox().width+c:f;y+r>d&&y>0&&(++m,y=0);var i="translate("+y+","+m*t()+")";return y+=r,i}return"translate(0,"+n*t()+")"})},a.x=function(t){return arguments.length?(o=t,a):o},a.y=function(t){return arguments.length?(l=t,a):l},a.gap=function(t){return arguments.length?(c=t,a):c},a.itemHeight=function(t){return arguments.length?(u=t,a):u},a.horizontal=function(t){return arguments.length?(s=t,a):s},a.legendWidth=function(t){return arguments.length?(d=t,a):d},a.itemWidth=function(t){return arguments.length?(f=t,a):f},a.autoItemWidth=function(t){return arguments.length?(h=t,a):h},a.legendText=function(t){return arguments.length?(g=t,a):g},a.maxItems=function(t){return arguments.length?(n=r.utils.isNumber(t)?t:void 0,a):n},a},r.htmlLegend=function(){var e,n,i,a,o={},l=r.pluck("name"),u=!1,c=!1;return o.parent=function(t){return arguments.length?(e=t,o):e},o.render=function(){var t=u?"dc-legend-item-horizontal":"dc-legend-item-vertical";n.select("div.dc-html-legend").remove();var o=n.append("div").attr("class","dc-html-legend");o.attr("style","max-width:"+n.nodes()[0].style.width);var s=e.legendables(),d=e.filters();void 0!==i&&(s=s.slice(0,i));var f=a||t,h=o.selectAll("div."+f).data(s).enter().append("div").classed(f,!0).on("mouseover",e.legendHighlight).on("mouseout",e.legendReset).on("click",e.legendToggle);c&&h.classed(r.constants.SELECTED_CLASS,function(t){return-1!==d.indexOf(t.name)}),h.append("span").attr("class","dc-legend-item-color").style("background-color",r.pluck("color")),h.append("span").attr("class","dc-legend-item-label").attr("title",l).text(l)},o.container=function(e){return arguments.length?(n=t.select(e),o):n},o.legendItemClass=function(t){return arguments.length?(a=t,o):a},o.highlightSelected=function(t){return arguments.length?(c=t,o):c},o.horizontal=function(t){return arguments.length?(u=t,o):u},o.legendText=function(t){return arguments.length?(l=t,o):l},o.maxItems=function(t){return arguments.length?(i=r.utils.isNumber(t)?t:void 0,o):i},o},r.scatterPlot=function(e,n){function i(t,e){return c(t)?b[e]?Math.pow(h,2):Math.pow(g,2):Math.pow(m,2)}function a(t,e){l.renderTitle()&&(t.selectAll("title").remove(),t.append("title").text(function(t){return l.title()(t)}))}function o(e,n){var i=l.chartBodyG().selectAll(".chart-body path.symbol").filter(function(){return e(t.select(this))}),a=u.size();u.size(Math.pow(n,2)),r.transition(i,l.transitionDuration(),l.transitionDelay()).attr("d",u),u.size(a)}var l=r.coordinateGridMixin({}),u=t.symbol(),c=function(t){return t.value},s=l.keyAccessor();l.keyAccessor(function(t){return s(t)[0]}),l.valueAccessor(function(t){return s(t)[1]}),l.colorAccessor(function(){return l._groupName}),l.title(function(t){return l.keyAccessor()(t)+","+l.valueAccessor()(t)+": "+l.existenceAccessor()(t)});var d=function(t){return"translate("+l.x()(l.keyAccessor()(t))+","+l.y()(l.valueAccessor()(t))+")"},f=7,h=5,g=3,p=null,y=1,m=0,v=0,x=1,A=null,b=[];return l.brush(t.brush()),u.size(i),r.override(l,"_filter",function(t){return arguments.length?l.__filter(r.filters.RangedTwoDimensionalFilter(t)):l.__filter()}),l.plotData=function(){var t=l.chartBodyG().selectAll("path.symbol").data(l.data());t=t.enter().append("path").attr("class","symbol").attr("opacity",0).attr("fill",l.getColor).attr("transform",d).merge(t),t.call(a,l.data()),t.each(function(t,e){b[e]=!l.filter()||l.filter().isFiltered([l.keyAccessor()(t),l.valueAccessor()(t)])}),r.transition(t,l.transitionDuration(),l.transitionDelay()).attr("opacity",function(t,e){return c(t)?b[e]?x:l.excludedOpacity():v}).attr("fill",function(t,e){return A&&!c(t)?A:l.excludedColor()&&!b[e]?l.excludedColor():l.getColor(t)}).attr("transform",d).attr("d",u),r.transition(t.exit(),l.transitionDuration(),l.transitionDelay()).attr("opacity",0).remove()},l.existenceAccessor=function(t){return arguments.length?(c=t,this):c},l.symbol=function(t){return arguments.length?(u.type(t),l):u.type()},l.customSymbol=function(t){return arguments.length?(u=t,u.size(i),l):u},l.symbolSize=function(t){return arguments.length?(h=t,l):h},l.highlightedSize=function(t){return arguments.length?(f=t,l):f},l.excludedSize=function(t){return arguments.length?(g=t,l):g},l.excludedColor=function(t){return arguments.length?(p=t,l):p},l.excludedOpacity=function(t){return arguments.length?(y=t,l):y},l.hiddenSize=l.emptySize=function(t){return arguments.length?(m=t,l):m},l.emptyColor=function(t){return arguments.length?(A=t,l):A},l.emptyOpacity=function(t){return arguments.length?(v=t,l):v},l.nonemptyOpacity=function(t){return arguments.length?(x=t,l):v},l.legendables=function(){return[{chart:l,name:l._groupName,color:l.getColor()}]},l.legendHighlight=function(e){o(function(t){return t.attr("fill")===e.color},f),l.chartBodyG().selectAll(".chart-body path.symbol").filter(function(){return t.select(this).attr("fill")!==e.color}).classed("fadeout",!0)},l.legendReset=function(e){o(function(t){return t.attr("fill")===e.color},h),l.chartBodyG().selectAll(".chart-body path.symbol").filter(function(){return t.select(this).attr("fill")!==e.color}).classed("fadeout",!1)},l.createBrushHandlePaths=function(){},l.extendBrush=function(t){return l.round()&&(t[0]=t[0].map(l.round()),t[1]=t[1].map(l.round())),t},l.brushIsEmpty=function(t){return!t||t[0][0]>=t[1][0]||t[0][1]>=t[1][1]},l._brushing=function(){if(t.event.sourceEvent&&(!t.event.sourceEvent.type||-1===["start","brush","end"].indexOf(t.event.sourceEvent.type))){var e=t.event.selection,n=l.brushIsEmpty(e);e&&(e=e.map(function(t){return t.map(function(t,e){return(0===e?l.x():l.y()).invert(t)})}),e=l.extendBrush(e),n=n&&l.brushIsEmpty(e)),l.redrawBrush(e,!1);var i=n?null:r.filters.RangedTwoDimensionalFilter(e);r.events.trigger(function(){l.replaceFilter(i),l.redrawGroup()},r.constants.EVENT_DELAY)}},l.redrawBrush=function(t,e){var n=l.brush(),i=l.gBrush();if(l.brushOn()&&i)if(l.resizing()&&l.setBrushExtents(e),t){t=t.map(function(t){return t.map(function(t,e){return(0===e?l.x():l.y())(t)})});var a=r.optionalTransition(e,l.transitionDuration(),l.transitionDelay())(i);a.call(n.move,t)}else i.call(n.move,t);l.fadeDeselectedArea(t)},l.setBrushY=function(t){t.call(l.brush().y(l.y()))},l.anchor(e,n)},r.numberDisplay=function(e,n){function i(t){if(!t.length)return null;var e=l._computeOrderedGroups(t);return e[e.length-1]}var a,o=t.format(".2s"),l=r.baseMixin({}),u={one:"",some:"",none:""};return l._mandatoryAttributes(["group"]),l.ordering(function(t){return t.value}),l.html=function(t){return arguments.length?(t.none?u.none=t.none:t.one?u.none=t.one:t.some&&(u.none=t.some),t.one?u.one=t.one:t.some&&(u.one=t.some),t.some?u.some=t.some:t.one&&(u.some=t.one),l):u},l.value=function(){return l.data()},l.data(function(t){var e=t.value?t.value():i(t.all());return l.valueAccessor()(e)}),l.transitionDuration(250),l.transitionDelay(0),l._doRender=function(){var e=l.value(),n=l.selectAll(".number-display");n.empty()&&(n=n.data([0]).enter().append("span").attr("class","number-display").merge(n)),n.transition().duration(l.transitionDuration()).delay(l.transitionDelay()).ease(t.easeQuad).tween("text",function(){var n=isFinite(a)?a:0,r=t.interpolateNumber(n||0,e);a=e;var i=this;return function(t){var n=null,a=l.formatNumber()(r(t));0===e&&""!==u.none?n=u.none:1===e&&""!==u.one?n=u.one:""!==u.some&&(n=u.some),i.innerHTML=n?n.replace("%number",a):a}})},l._doRedraw=function(){return l._doRender()},l.formatNumber=function(t){return arguments.length?(o=t,l):o},l.anchor(e,n)},r.heatMap=function(e,n){function i(t,e){var n=g.selectAll(".box-group").filter(function(n){return n.key[t]===e}),i=n.filter(function(t){return!g.hasFilter(t.key)});r.events.trigger(function(){var t=i.empty()?n:i,e=t.data().map(function(t){return r.filters.TwoDimensionalFilter(t.key)});g._filter([e]),g.redrawGroup()})}var a,o,l,u=t.ascending,c=t.ascending,s=t.scaleBand(),d=t.scaleBand(),f=6.75,h=6.75,g=r.colorMixin(r.marginMixin(r.baseMixin({})));g._mandatoryAttributes(["group"]),g.title(g.colorAccessor());var p=function(t){return t},y=function(t){return t};g.colsLabel=function(t){return arguments.length?(p=t,g):p},g.rowsLabel=function(t){return arguments.length?(y=t,g):y};var m=function(t){i(0,t)},v=function(t){i(1,t)},x=function(t){var e=t.key;r.events.trigger(function(){g.filter(e),g.redrawGroup()})};return r.override(g,"filter",function(t){return arguments.length?g._filter(r.filters.TwoDimensionalFilter(t)):g._filter()}),g.rows=function(t){return arguments.length?(l=t,g):l},g.rowOrdering=function(t){return arguments.length?(c=t,g):c},g.cols=function(t){return arguments.length?(o=t,g):o},g.colOrdering=function(t){return arguments.length?(u=t,g):u},g._doRender=function(){return g.resetSvg(),a=g.svg().append("g").attr("class","heatmap").attr("transform","translate("+g.margins().left+","+g.margins().top+")"),g._doRedraw()},g._doRedraw=function(){var t=g.data(),e=g.rows()||t.map(g.valueAccessor()),n=g.cols()||t.map(g.keyAccessor());c&&(e=e.sort(c)),u&&(n=n.sort(u)),e=d.domain(e),n=s.domain(n);var i=e.domain().length,o=n.domain().length,l=Math.floor(g.effectiveWidth()/o),p=Math.floor(g.effectiveHeight()/i);n.rangeRound([0,g.effectiveWidth()]),e.rangeRound([g.effectiveHeight(),0]);var y=a.selectAll("g.box-group").data(g.data(),function(t,e){return g.keyAccessor()(t,e)+"\0"+g.valueAccessor()(t,e)});y.exit().remove();var m=y.enter().append("g").attr("class","box-group");m.append("rect").attr("class","heat-box").attr("fill","white").attr("x",function(t,e){return n(g.keyAccessor()(t,e))}).attr("y",function(t,n){return e(g.valueAccessor()(t,n))}).on("click",g.boxOnClick()),g.renderTitle()&&(m.append("title"),y.select("title").text(g.title())),y=m.merge(y),r.transition(y.select("rect"),g.transitionDuration(),g.transitionDelay()).attr("x",function(t,e){return n(g.keyAccessor()(t,e))}).attr("y",function(t,n){return e(g.valueAccessor()(t,n))}).attr("rx",f).attr("ry",h).attr("fill",g.getColor).attr("width",l).attr("height",p);var v=a.select("g.cols");v.empty()&&(v=a.append("g").attr("class","cols axis"));var x=v.selectAll("text").data(n.domain());x.exit().remove(),x=x.enter().append("text").attr("x",function(t){return n(t)+l/2}).style("text-anchor","middle").attr("y",g.effectiveHeight()).attr("dy",12).on("click",g.xAxisOnClick()).text(g.colsLabel()).merge(x),r.transition(x,g.transitionDuration(),g.transitionDelay()).text(g.colsLabel()).attr("x",function(t){return n(t)+l/2}).attr("y",g.effectiveHeight());var A=a.select("g.rows");A.empty()&&(A=a.append("g").attr("class","rows axis"));var b=A.selectAll("text").data(e.domain());return b.exit().remove(),b=b.enter().append("text").style("text-anchor","end").attr("x",0).attr("dx",-2).attr("y",function(t){return e(t)+p/2}).attr("dy",6).on("click",g.yAxisOnClick()).text(g.rowsLabel()).merge(b),r.transition(b,g.transitionDuration(),g.transitionDelay()).text(g.rowsLabel()).attr("y",function(t){return e(t)+p/2}),g.hasFilter()?g.selectAll("g.box-group").each(function(t){g.isSelectedNode(t)?g.highlightSelected(this):g.fadeDeselected(this)}):g.selectAll("g.box-group").each(function(){g.resetHighlight(this)}),g},g.boxOnClick=function(t){return arguments.length?(x=t,g):x},g.xAxisOnClick=function(t){return arguments.length?(m=t,g):m},g.yAxisOnClick=function(t){return arguments.length?(v=t,g):v},g.xBorderRadius=function(t){return arguments.length?(f=t,g):f},g.yBorderRadius=function(t){return arguments.length?(h=t,g):h},g.isSelectedNode=function(t){return g.hasFilter(t.key)},g.anchor(e,n)},function(){function e(t){return[0,t.length-1]}function n(e){return[t.quantile(e,.25),t.quantile(e,.5),t.quantile(e,.75)]}t.box=function(){function i(e){e.each(function(e,n){e=e.map(s).sort(t.ascending);var r=t.select(this),i=e.length,g=e[0],p=e[i-1],y=e.quartiles=f(e),m=d&&d.call(this,e,n),v=m&&m.map(function(t){return e[t]}),x=m?t.range(0,m[0]).concat(t.range(m[1]+1,i)):t.range(i),A=t.scaleLinear().domain(c&&c.call(this,e,n)||[g,p]).range([o,0]),b=this.__chart__||t.scaleLinear().domain([0,1/0]).range(A.range());this.__chart__=A;var _=r.selectAll("line.center").data(v?[v]:[]);_.enter().insert("line","rect").attr("class","center").attr("x1",a/2).attr("y1",function(t){return b(t[0])}).attr("x2",a/2).attr("y2",function(t){return b(t[1])}).style("opacity",1e-6).transition().duration(l).delay(u).style("opacity",1).attr("y1",function(t){return A(t[0])}).attr("y2",function(t){return A(t[1])}),_.transition().duration(l).delay(u).style("opacity",1).attr("x1",a/2).attr("x2",a/2).attr("y1",function(t){return A(t[0])}).attr("y2",function(t){return A(t[1])}),_.exit().transition().duration(l).delay(u).style("opacity",1e-6).attr("y1",function(t){return A(t[0])}).attr("y2",function(t){return A(t[1])}).remove();var k=r.selectAll("rect.box").data([y]);k.enter().append("rect").attr("class","box").attr("x",0).attr("y",function(t){return b(t[2])}).attr("width",a).attr("height",function(t){return b(t[0])-b(t[2])}).transition().duration(l).delay(u).attr("y",function(t){return A(t[2])}).attr("height",function(t){return A(t[0])-A(t[2])}),k.transition().duration(l).delay(u).attr("width",a).attr("y",function(t){return A(t[2])}).attr("height",function(t){return A(t[0])-A(t[2])});var w=r.selectAll("line.median").data([y[1]]);w.enter().append("line").attr("class","median").attr("x1",0).attr("y1",b).attr("x2",a).attr("y2",b).transition().duration(l).delay(u).attr("y1",A).attr("y2",A),w.transition().duration(l).delay(u).attr("x1",0).attr("x2",a).attr("y1",A).attr("y2",A);var D=r.selectAll("line.whisker").data(v||[]);D.enter().insert("line","circle, text").attr("class","whisker").attr("x1",0).attr("y1",b).attr("x2",a).attr("y2",b).style("opacity",1e-6).transition().duration(l).delay(u).attr("y1",A).attr("y2",A).style("opacity",1),D.transition().duration(l).delay(u).attr("x1",0).attr("x2",a).attr("y1",A).attr("y2",A).style("opacity",1),D.exit().transition().duration(l).delay(u).attr("y1",A).attr("y2",A).style("opacity",1e-6).remove();var C=r.selectAll("circle.outlier").data(x,Number);C.enter().insert("circle","text").attr("class","outlier").attr("r",5).attr("cx",a/2).attr("cy",function(t){return b(e[t])}).style("opacity",1e-6).transition().duration(l).delay(u).attr("cy",function(t){return A(e[t])}).style("opacity",1),C.transition().duration(l).delay(u).attr("cx",a/2).attr("cy",function(t){return A(e[t])}).style("opacity",1),C.exit().transition().duration(l).delay(u).attr("cy",function(t){return A(e[t])}).style("opacity",1e-6).remove();var L=h||A.tickFormat(8),E=r.selectAll("text.box").data(y);E.enter().append("text").attr("class","box").attr("dy",".3em").attr("dx",function(t,e){return 1&e?6:-6}).attr("x",function(t,e){return 1&e?a:0}).attr("y",b).attr("text-anchor",function(t,e){return 1&e?"start":"end"}).text(L).transition().duration(l).delay(u).attr("y",A),E.transition().duration(l).delay(u).text(L).attr("x",function(t,e){return 1&e?a:0}).attr("y",A);var R=r.selectAll("text.whisker").data(v||[]);R.enter().append("text").attr("class","whisker").attr("dy",".3em").attr("dx",6).attr("x",a).attr("y",b).text(L).style("opacity",1e-6).transition().duration(l).delay(u).attr("y",A).style("opacity",1),R.transition().duration(l).delay(u).text(L).attr("x",a).attr("y",A).style("opacity",1),R.exit().transition().duration(l).delay(u).attr("y",A).style("opacity",1e-6).remove()}),t.timerFlush()}var a=1,o=1,l=0,u=0,c=null,s=Number,d=e,f=n,h=null;return i.width=function(t){return arguments.length?(a=t,i):a},i.height=function(t){return arguments.length?(o=t,i):o},i.tickFormat=function(t){return arguments.length?(h=t,i):h},i.duration=function(t){return arguments.length?(l=t,i):l},i.domain=function(t){return arguments.length?(c=null===t?t:"function"==typeof t?t:r.utils.constant(t),i):c},i.value=function(t){return arguments.length?(s=t,i):s},i.whiskers=function(t){return arguments.length?(d=t,i):d},i.quartiles=function(t){return arguments.length?(f=t,i):f},i}}(),r.boxPlot=function(e,n){function i(t){return function(e){var n=e.quartiles[0],r=e.quartiles[2],i=(r-n)*t,a=-1,o=e.length;do{++a}while(e[a]<n-i);do{--o}while(e[o]>r+i);return[a,o]}}function a(t){var e=t.enter().append("g");return e.attr("class","box").attr("transform",g).call(d).on("click",function(t){u.filter(u.keyAccessor()(t)),u.redrawGroup()}),e.merge(t)}function o(e){r.transition(e,u.transitionDuration(),u.transitionDelay()).attr("transform",g).call(d).each(function(){t.select(this).select("rect.box").attr("fill",u.getColor)})}function l(t){t.exit().remove().call(d)}
var u=r.coordinateGridMixin({}),c=i,s=c(1.5),d=t.box(),f=null,h=function(t,e){return u.isOrdinal()?u.x().bandwidth():t/(1+u.boxPadding())/e};u.yAxisPadding(12),u.x(t.scaleBand()),u.xUnits(r.units.ordinal),u.data(function(t){return t.all().map(function(t){return t.map=function(e){return e.call(t,t)},t}).filter(function(t){return 0!==u.valueAccessor()(t).length})}),u.boxPadding=u._rangeBandPadding,u.boxPadding(.8),u.outerPadding=u._outerRangeBandPadding,u.outerPadding(.5),u.boxWidth=function(t){return arguments.length?(h="function"==typeof t?t:r.utils.constant(t),u):h};var g=function(t,e){return"translate("+u.x()(u.keyAccessor()(t,e))+", 0)"};return u._preprocessData=function(){u.elasticX()&&u.x().domain([])},u.plotData=function(){var t=h(u.effectiveWidth(),u.xUnitCount());d.whiskers(s).width(t).height(u.effectiveHeight()).value(u.valueAccessor()).domain(u.y().domain()).duration(u.transitionDuration()).tickFormat(f);var e=u.chartBodyG().selectAll("g.box").data(u.data(),u.keyAccessor());o(a(e)),l(e),u.fadeDeselectedArea(u.filter())},u.fadeDeselectedArea=function(t){if(u.hasFilter())if(u.isOrdinal())u.g().selectAll("g.box").each(function(t){u.isSelectedNode(t)?u.highlightSelected(this):u.fadeDeselected(this)});else{if(!u.brushOn()&&!u.parentBrushOn())return;var e=t[0],n=t[1],r=u.keyAccessor();u.g().selectAll("g.box").each(function(t){var i=r(t);i<e||i>=n?u.fadeDeselected(this):u.highlightSelected(this)})}else u.g().selectAll("g.box").each(function(){u.resetHighlight(this)})},u.isSelectedNode=function(t){return u.hasFilter(u.keyAccessor()(t))},u.yAxisMin=function(){var e=t.min(u.data(),function(e){return t.min(u.valueAccessor()(e))});return r.utils.subtract(e,u.yAxisPadding())},u.yAxisMax=function(){var e=t.max(u.data(),function(e){return t.max(u.valueAccessor()(e))});return r.utils.add(e,u.yAxisPadding())},u.tickFormat=function(t){return arguments.length?(f=t,u):f},u.anchor(e,n)},r.selectMenu=function(e,n){function i(){var t=l.selectAll("option."+u).data(c.data(),function(t){return c.keyAccessor()(t)});t.exit().remove(),t.enter().append("option").classed(u,!0).attr("value",function(t){return c.keyAccessor()(t)}).merge(t).text(c.title()),l.selectAll("option."+u).sort(g),l.on("change",a)}function a(e,n){var r,i=t.event.target;if(i.selectedOptions){r=Array.prototype.slice.call(i.selectedOptions).map(function(t){return t.value})}else{r=[].slice.call(t.event.target.options).filter(function(t){return t.selected}).map(function(t){return t.value})}1===r.length&&""===r[0]?r=f||null:d||1!==r.length||(r=r[0]),c.onChange(r)}function o(){d?l.attr("multiple",!0):l.attr("multiple",null),null!==h?l.attr("size",h):l.attr("size",null)}var l,u="dc-select-option",c=r.baseMixin({}),s="Select all",d=!1,f=null,h=null,g=function(t,e){return c.keyAccessor()(t)>c.keyAccessor()(e)?1:c.keyAccessor()(e)>c.keyAccessor()(t)?-1:0},p=function(t){return c.valueAccessor()(t)>0};c.data(function(t){return t.all().filter(p)}),c._doRender=function(){return c.select("select").remove(),l=c.root().append("select").classed("dc-select-menu",!0),l.append("option").text(s).attr("value",""),c._doRedraw(),c};var y=window.navigator.userAgent;return y.indexOf("Trident/")>0&&-1===y.indexOf("MSIE")&&(c.redraw=c.render),c._doRedraw=function(){return o(),i(),c.hasFilter()&&d?l.selectAll("option").property("selected",function(t){return void 0!==t&&c.filters().indexOf(String(c.keyAccessor()(t)))>=0}):c.hasFilter()?l.property("value",c.filter()):l.property("value",""),c},c.onChange=function(t){t&&d?c.replaceFilter([t]):t?c.replaceFilter(t):c.filterAll(),r.events.trigger(function(){c.redrawGroup()})},c.order=function(t){return arguments.length?(g=t,c):g},c.promptText=function(t){return arguments.length?(s=t,c):s},c.filterDisplayed=function(t){return arguments.length?(p=t,c):p},c.multiple=function(t){return arguments.length?(d=t,c):d},c.promptValue=function(t){return arguments.length?(f=t,c):f},c.numberVisible=function(t){return arguments.length?(h=t,c):h},c.size=r.logger.deprecate(c.numberVisible,"selectMenu.size is ambiguous - use numberVisible instead"),c.anchor(e,n)},r.textFilterWidget=function(t,e){var n=r.baseMixin({}),i=function(t){return t.toLowerCase()},a=function(t){return t=i(t),function(e){return-1!==i(e).indexOf(t)}},o="search";return n.group(function(){throw"the group function on textFilterWidget should never be called, please report the issue"}),n._doRender=function(){return n.select("input").remove(),n.root().append("input").classed("dc-text-filter-input",!0).on("input",function(){n.dimension().filterFunction(a(this.value)),r.events.trigger(function(){r.redrawAll()},r.constants.EVENT_DELAY)}),n._doRedraw(),n},n._doRedraw=function(){return n.root().selectAll("input").attr("placeholder",o),n},n.normalize=function(t){return arguments.length?(i=t,n):i},n.placeHolder=function(t){return arguments.length?(o=t,n):o},n.filterFunctionFactory=function(t){return arguments.length?(a=t,n):a},n.anchor(t,e)},r.cboxMenu=function(e,n){function i(){var t=o.selectAll("li."+l).data(u.data(),function(t){return u.keyAccessor()(t)});if(t.exit().remove(),t=t.enter().append("li").classed(l,!0).merge(t),t.append("input").attr("type",d).attr("value",function(t){return u.keyAccessor()(t)}).attr("name","domain_"+h).attr("id",function(t,e){return"input_"+h+"_"+e}),t.append("label").attr("for",function(t,e){return"input_"+h+"_"+e}).text(u.title()),s)o.append("li").append("input").attr("type","reset").text(c).on("click",a);else{var e=o.append("li");e.append("input").attr("type",d).attr("value",f).attr("name","domain_"+h).attr("id",function(t,e){return"input_"+h+"_all"}).property("checked",!0),e.append("label").attr("for",function(t,e){return"input_"+h+"_all"}).text(c)}return o.selectAll("li."+l).sort(g),o.on("change",a),t}function a(e,n){var r,i,a=t.select(t.event.target);a.datum()?(i=t.select(this).selectAll("input").filter(function(t){if(t)return this.checked}),r=i.nodes().map(function(t){return t.value}),s||1!==r.length||(r=r[0])):r=f||null,u.onChange(r)}var o,l="dc-cbox-item",u=r.baseMixin({}),c="Select all",s=!1,d="radio",f=null,h=Math.floor(1e5*Math.random())+1,g=function(t,e){return u.keyAccessor()(t)>u.keyAccessor()(e)?1:u.keyAccessor()(e)>u.keyAccessor()(t)?-1:0},p=function(t){return u.valueAccessor()(t)>0};return u.data(function(t){return t.all().filter(p)}),u._doRender=function(){return u._doRedraw()},u._doRedraw=function(){return u.select("ul").remove(),o=u.root().append("ul").classed("dc-cbox-group",!0),i(),u.hasFilter()&&s?o.selectAll("input").property("checked",function(t){return t&&u.filters().indexOf(String(u.keyAccessor()(t)))>=0||!1}):u.hasFilter()&&o.selectAll("input").property("checked",function(t){return!!t&&u.keyAccessor()(t)===u.filter()}),u},u.onChange=function(t){t&&s?u.replaceFilter([t]):t?u.replaceFilter(t):u.filterAll(),r.events.trigger(function(){u.redrawGroup()})},u.order=function(t){return arguments.length?(g=t,u):g},u.promptText=function(t){return arguments.length?(c=t,u):c},u.filterDisplayed=function(t){return arguments.length?(p=t,u):p},u.multiple=function(t){return arguments.length?(s=t,d=s?"checkbox":"radio",u):s},u.promptValue=function(t){return arguments.length?(f=t,u):f},u.anchor(e,n)},r.abstractBubbleChart=r.bubbleMixin,r.baseChart=r.baseMixin,r.capped=r.capMixin,r.colorChart=r.colorMixin,r.coordinateGridChart=r.coordinateGridMixin,r.marginable=r.marginMixin,r.stackableChart=r.stackMixin,r.d3=t,r.crossfilter=e,r}if("function"==typeof define&&define.amd)define(["d3","crossfilter2"],t);else if("object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports){var e=require("d3"),n=require("crossfilter2");"function"!=typeof n&&(n=n.crossfilter),module.exports=t(e,n)}else this.dc=t(d3,crossfilter)}();var PODLOVE=PODLOVE||{};PODLOVE.Analytics=PODLOVE.Analytics||{},dc.config.defaultColors(d3.schemeAccent),PODLOVE.Analytics.decimalRound=function(t,e){var n=Math.pow(10,e);return t*=n,t=Math.round(t),t/=n},PODLOVE.Analytics.formatThousands=function(t){return t<1e3?t:PODLOVE.Analytics.decimalRound(t/1e3,1)+"k"},PODLOVE.Analytics.hourFormat=function(t){var e=0,n=0,r=[];return t>48&&(e=(t-t%24)/24,t%=24),e>13&&(n=(e-e%7)/7,e%=7),n&&r.push(PODLOVE.Analytics.decimalRound(n,1)+"w"),e&&r.push(PODLOVE.Analytics.decimalRound(e,1)+"d"),t&&r.push(PODLOVE.Analytics.decimalRound(t,1)+"h"),0===r.length&&(r=["0h"]),r.join(" ")},Number.isNaN=Number.isNaN||function(t){return t!==t},jQuery(document).ready(function(t){function e(e){var n=e.hours_per_unit,o=crossfilter(r),g=crossfilter(i),p=o.groupAll().reduce(d,f,h),y=function(e){var n=e.data(),r=e.filters();n.forEach(function(n,i){var a=e.select("g.row._"+i),o=e.select("g.row._"+i+" text"),l="";a.select(".subLabel").size()||a.append("text").attr("class","subLabel").attr("text-anchor","end").attr("x",-10).attr("y",o.attr("y")),r.length>0&&-1===t.inArray(n.key,r)?a.select(".subLabel").style({display:"none"}):a.select(".subLabel").style({display:"inherit"}),p.value().downloads>0&&(l=Math.round(n.value.downloads/p.value().downloads*100)+"%"),a.select(".subLabel").text(l)})},m=function(t,e){t.select(".reset").on("click",function(e,n){d3.event.preventDefault(),t.filterAll(),dc.redrawAll()})},v=function(t){return Math.floor(t.hoursSinceRelease/n)},x=o.dimension(v),A=g.dimension(v),b=o.dimension(function(t){return t.asset_id}),_=o.dimension(function(t){return t.client}),k=o.dimension(function(t){return t.system}),w=o.dimension(function(t){return t.source}),D=o.dimension(function(t){return t.context}),C=o.dimension(function(t){return t.geo}),L=x.group().reduce(d,f,h),E=A.group().reduce(d,f,h),R=x.group().reduce(d,f,h).all().reduce(function(t,e){return e.key+=1,e.value.cum=!0,t.length&&(e.value.downloads+=t.slice(-1)[0].value.downloads),t.push(e),t},[]);R.unshift({key:0,value:{date:0,downloads:0,cum:!0}});var O={all:function(){return R}},S=b.group().reduce(d,f,h),M=_.group().reduce(d,f,h).order(function(t){return t.downloads}),F=k.group().reduce(d,f,h).order(function(t){return t.downloads}),B=w.group().reduce(d,f,h),T=D.group().reduce(d,f,h),N=C.group().reduce(d,f,h),H=dc.compositeChart("#episode-performance-chart"),P=dc.barChart(H).dimension(x).group(L,"Current Episode").renderTitle(!0).valueAccessor(function(t){return t.value.downloads}).gap(1).colors("#69B3FF"),G=dc.barChart(H).dimension(x).group(E,"Average Episode").renderTitle(!0).colors("#224BA6").valueAccessor(function(t){return t.value.downloads}).barPadding(2),V=dc.lineChart(H).dimension(x).group(O,"Cumulative").colors("#CCC").useRightYAxis(!0).valueAccessor(function(t){return t.value.downloads}).renderDataPoints({}).renderArea(!0),z=L.all().reduce(function(t,e){return Math.max(t,e.key)},0),U=dc.barChart("#episode-range-chart").width(l).height(80).dimension(x).group(L).x(d3.scaleLinear().domain([0,z])).valueAccessor(function(t){return t.value.downloads}).colors("#69B3FF").yAxisLabel(" ");window.rangeChart=U,H.width(l).x(d3.scaleLinear().domain([0,1/0])).legend(dc.legend().x(l-160).y(20).itemHeight(13).gap(5)).elasticX(!1).brushOn(!1).transitionDuration(0).yAxisLabel("Downloads").xAxisLabel("Hours since release").rangeChart(U).title(function(t){var e=t.value.date?a(t.value.date):"Average Episode",r="";return r=t.value.cum?t.key*n+"h after release":t.key*n+"h  "+(t.key+1)*n+"h after release",[e,r,"Downloads: "+t.value.downloads].join("\n")}).compose([V,P,G]).rightYAxisLabel("Cumulative Downloads");var Y=dc.rowChart("#episode-asset-chart").margins({top:0,left:40,right:10,bottom:25}).elasticX(!0).dimension(b).group(S).valueAccessor(function(t){return t.value?t.value.downloads:0}).ordering(function(t){return-t.value.downloads}).label(function(t){return assetNames[t.key]}).title(function(t){return t.value.downloads}).colors("#69B3FF").on("preRedraw",y).on("renderlet",m),I=dc.rowChart("#episode-client-chart").margins({top:0,left:40,right:10,bottom:25}).elasticX(!0).dimension(_).group(M).valueAccessor(function(t){return t.value.downloads}).ordering(function(t){return-t.value.downloads}).othersGrouper(function(t){return t}).cap(10).label(function(t){return t.key}).colors("#69B3FF").on("preRedraw",y).on("renderlet",m),j=dc.rowChart("#episode-system-chart").margins({top:0,left:40,right:10,bottom:25}).elasticX(!0).dimension(k).group(F).valueAccessor(function(t){return t.value.downloads}).ordering(function(t){return-t.value.downloads}).othersGrouper(function(t){return t}).cap(10).label(function(t){return t.key}).colors("#69B3FF").on("preRedraw",y).on("renderlet",m),X=dc.rowChart("#episode-source-chart").margins({top:0,left:40,right:10,bottom:25}).elasticX(!0).dimension(w).group(B).valueAccessor(function(t){return t.value.downloads}).ordering(function(t){return-t.value.downloads}).label(function(t){return t.key}).colors("#69B3FF").on("preRedraw",y).on("renderlet",m),q=dc.rowChart("#episode-context-chart").margins({top:0,left:40,right:10,bottom:25}).elasticX(!0).dimension(D).group(T).valueAccessor(function(t){return t.value.downloads}).ordering(function(t){return-t.value.downloads}).label(function(t){return t.value.source+"/"+t.key}).colors("#69B3FF").on("preRedraw",y).on("renderlet",m),W=dc.rowChart("#episode-geo-chart").margins({top:0,left:40,right:10,bottom:25}).elasticX(!0).cap(10).dimension(C).group(N).valueAccessor(function(t){return t.value.downloads}).ordering(function(t){return-t.value.downloads}).othersGrouper(function(t){return t}).colors("#69B3FF").on("preRedraw",y).on("renderlet",m);U.yAxis().ticks([2]),U.xAxis().tickFormat(function(t){return PODLOVE.Analytics.hourFormat(t*n)}),H.xAxis().tickFormat(function(t){return PODLOVE.Analytics.hourFormat(t*n)}),U.yAxis().tickFormat(PODLOVE.Analytics.formatThousands),H.yAxis().tickFormat(PODLOVE.Analytics.formatThousands),H.rightYAxis().tickFormat(PODLOVE.Analytics.formatThousands),Y.xAxis().tickFormat(PODLOVE.Analytics.formatThousands),I.xAxis().tickFormat(PODLOVE.Analytics.formatThousands),j.xAxis().tickFormat(PODLOVE.Analytics.formatThousands),X.xAxis().tickFormat(PODLOVE.Analytics.formatThousands),q.xAxis().tickFormat(PODLOVE.Analytics.formatThousands),W.xAxis().tickFormat(PODLOVE.Analytics.formatThousands),c=function(){H.elasticY(!0).compose([V,P,G]),H.render()},s=function(){H.elasticY(!0).compose([V,P]),H.render()},[H,U,Y,I,j,X,q,W].forEach(function(t){t.render()});var K=function(t,e){dc.filterAll(),U.filter(dc.filters.RangedFilter(t/n,e/n)),dc.redrawAll()};window.filterHours=K,u.min||u.max||(u.min=0,u.max=168,t("#chart-zoom-selection .button:eq(1)").addClass("active")),t("#chart-zoom-selection .button").on("click",function(e){var r=parseInt(t(this).data("hours"),10);e.preventDefault(),t(this).hasClass("disabled")||(t(this).siblings().removeClass("active"),t(this).addClass("active"),0===r?(u.min=0,u.max=U.xUnitCount()*n):u.max=u.min+r,K(u.min,u.max))}),e.rendered&&e.rendered instanceof Function&&e.rendered()}function n(n){r?e(n):t.when(t.ajax(ajaxurl+"?action=podlove-analytics-episode-downloads-per-hour&episode="+o),t.ajax(ajaxurl+"?action=podlove-analytics-episode-average-downloads-per-hour")).done(function(t,a){var o=function(t){return{date:new Date(1e3*+t.date),downloads:+t.downloads,hoursSinceRelease:+t.hours_since_release,asset_id:+t.asset_id,client:t.client?t.client:"Unknown",system:t.system?t.system:"Unknown",source:t.source?t.source:"Unknown",context:t.context?t.context:"Unknown",geo:t.geo?t.geo:"Unknown"}};r=d3.csvParse(t[0],o),i=d3.csvParse(a[0],function(t){return{hoursSinceRelease:+t.hoursSinceRelease,downloads:+t.downloads}}),e(n)})}var r,i,a=d3.timeFormat("%Y-%m-%d %H:%M %Z"),o=jQuery("#episode-performance-chart").data("episode"),l=t("#episode-performance-chart").closest(".inside").width(),u={min:null,max:null},c=void 0,s=void 0,d=function(t,e){return t.downloads+=e.downloads,t.asset_id=e.asset_id,t.date=t.date&&t.date<e.date?t.date:e.date,t.client=e.client,t.system=e.system,t.source=e.source,t.context=e.context,t.geo=e.geo,t},f=function(t,e){return t.downloads-=e.downloads,t},h=function(){return{downloads:0,asset_id:0,date:0,client:"",system:"",geo:""}};t("#chart-grouping-selection").on("click","a",function(e){var r=parseInt(t(this).data("hours"),10),i=parseInt(t("#chart-zoom-selection .button.active").data("hours"),10);t(this).siblings().removeClass("active"),t(this).addClass("active"),t("#chart-zoom-selection a.button").each(function(){var e=parseInt(t(this).data("hours"),10);0!==e&&e<r?t(this).addClass("disabled"):t(this).removeClass("disabled")}),n({hours_per_unit:r,rendered:function(){0!==i&&(Number.isNaN(i)||i<r)?t("#chart-zoom-selection a.button").filter(function(){var e=parseInt(t(this).data("hours"),10);return 0===e||e>=r}).first().click():t("#chart-zoom-selection a.button.active:first").click()}}),e.preventDefault()}),t("#chart-grouping-selection a:eq(3)").click(),t("input[name='podlove_analytics_tiles']").each(function(){var e=t(this).attr("checked"),n=t(this).val(),r=t(".chart-wrapper[data-tile-id='"+n+"']");e||r.hide()}).on("click",function(){var e=t(this).attr("checked"),n=t(this).val(),r=t(".chart-wrapper[data-tile-id='"+n+"']");t.ajax({url:ajaxurl,data:{action:"podlove-analytics-settings-tiles-update",tile_id:n,checked:e}}),e?r.show():r.hide()});var g=function e(){if(void 0===s)window.setTimeout(e,500);else{t("#average-episode").attr("checked")?c():s()}},p=function(){t.ajax({url:ajaxurl,data:{action:"podlove-analytics-settings-avg-update",checked:t(this).attr("checked")}})};t("#average-episode").each(g).on("click",function(){p(),g()})}),jQuery(document).ready(function(t){function e(){var e=t("#total-chart").closest(".wrap").width(),o=crossfilter(n),l=o.groupAll().reduce(r,i,a),u=l.value().downloads,c=o.dimension(function(t){return d3.timeDay(t.date)}),s=o.dimension(function(t){return t.episode_id}),d=s.group().reduce(function(t,e){return t.downloads+=e.downloads,t.episode_id=e.episode_id,t},null,function(){return{downloads:0,episode_id:0}}),f=d.all().reduce(function(t,e){return e.value.downloads>.05*u&&t.push(e),t},[]),h=_.pluck(f,"key"),g=c.group().reduce(function(t,e){return _.contains(h,e.episode_id)?t:r(t,e)},function(t,e){return _.contains(h,e.episode_id)?t:i(t,e)},a),p=[];for(var y in h)p[h[y]]=function(t,e){return t.group().reduce(function(t,n){return n.episode_id==e?r(t,n):t},function(t,n){return n.episode_id==e?i(t,n):t},a)}(c,h[y]);var m=d3.timeFormat("%Y-%m-%d"),v=dc.barChart("#total-chart").width(e).height(200).dimension(c).group(g,"Other Episodes").x(d3.scaleTime().domain([function(t){return new Date((new Date).setDate((new Date).getDate()-t))}(28),new Date])).xUnits(d3.timeDays).brushOn(!1).renderTitle(!0).elasticY(!0).yAxisLabel("Downloads").valueAccessor(function(t){return t.value.downloads}).title(function(t){return[m(t.key),"Downloads: "+t.value.downloads].join("\n")}).renderHorizontalGridLines(!0);if(e>650){var x=e-300;jQuery("#total-chart").height("200px"),v.height(200),v.legend(dc.legend().horizontal(!1).x(x).y(10).autoItemWidth(!0)),v.margins().bottom=30,v.margins().right=305}else{var x=e-300;jQuery("#total-chart").height("370px"),v.height(370),v.legend(dc.legend().horizontal(!1).x(30).y(170).autoItemWidth(!0)),v.margins().bottom=230}for(var y in p)v.stack(p[y],podlove_episode_names[y]);v.yAxis().tickFormat(PODLOVE.Analytics.formatThousands),v.xAxis().tickFormat(d3.timeFormat("%d %b")),e<550?v.xAxis().ticks(d3.timeDay,5):e<635?v.xAxis().ticks(d3.timeDay,4):e<780?v.xAxis().ticks(d3.timeDay,3):v.xAxis().ticks(d3.timeDay,2),v.render()}var n,r=function(t,e){return t.downloads+=e.downloads,t.episode_id=e.episode_id,t.date=e.date,t},i=function(t,e){return t.downloads-=e.downloads,t},a=function(){return{downloads:0,episode_id:0,date:0}};t("#total-chart").length&&function(){n?(e(),t(window).on("resize",e)):t.when(t.ajax(ajaxurl+"?action=podlove-analytics-total-downloads-per-day")).done(function(r){var i=function(t){return{date:new Date(1e3*+t.date),downloads:+t.downloads,episode_id:+t.episode_id}};n=d3.csvParse(r,i),e(),t(window).on("resize",e)})}()});